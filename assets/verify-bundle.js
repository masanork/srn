var Qq=Object.create;var{getPrototypeOf:qq,defineProperty:CJ,getOwnPropertyNames:Xq}=Object;var Yq=Object.prototype.hasOwnProperty;var Zq=($,J,Q)=>{Q=$!=null?Qq(qq($)):{};let q=J||!$||!$.__esModule?CJ(Q,"default",{value:$,enumerable:!0}):Q;for(let X of Xq($))if(!Yq.call(q,X))CJ(q,X,{get:()=>$[X],enumerable:!0});return q};var Gq=($,J)=>()=>(J||$((J={exports:{}}).exports,J),J.exports);var IJ=Gq((T9,HJ)=>{HJ.exports=function $(J){if(typeof J==="number"&&isNaN(J))throw new Error("NaN is not allowed");if(typeof J==="number"&&!isFinite(J))throw new Error("Infinity is not allowed");if(J===null||typeof J!=="object")return JSON.stringify(J);if(J.toJSON instanceof Function)return $(J.toJSON());if(Array.isArray(J))return`[${J.reduce((X,Y,Z)=>{return`${X}${Z===0?"":","}${$(Y===void 0||typeof Y==="symbol"?null:Y)}`},"")}]`;return`{${Object.keys(J).sort().reduce((q,X)=>{if(J[X]===void 0||typeof J[X]==="symbol")return q;let Y=q.length===0?"":",";return`${q}${Y}${$(X)}:${$(J[X])}`},"")}}`}});var eQ=Zq(IJ(),1);/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function C0($){return $ instanceof Uint8Array||ArrayBuffer.isView($)&&$.constructor.name==="Uint8Array"}function a$($,J=""){if(!Number.isSafeInteger($)||$<0){let Q=J&&`"${J}" `;throw new Error(`${Q}expected integer >= 0, got ${$}`)}}function n($,J,Q=""){let q=C0($),X=$?.length,Y=J!==void 0;if(!q||Y&&X!==J){let Z=Q&&`"${Q}" `,W=Y?` of length ${J}`:"",G=q?`length=${X}`:`type=${typeof $}`;throw new Error(Z+"expected Uint8Array"+W+", got "+G)}return $}function H0($,J=!0){if($.destroyed)throw new Error("Hash instance has been destroyed");if(J&&$.finished)throw new Error("Hash#digest() has already been called")}function l0($,J){n($,void 0,"digestInto() output");let Q=J.outputLen;if($.length<Q)throw new Error('"digestInto() output" expected to be of length >='+Q)}function BJ($){return new Uint32Array($.buffer,$.byteOffset,Math.floor($.byteLength/4))}function y$(...$){for(let J=0;J<$.length;J++)$[J].fill(0)}function n0($){return new DataView($.buffer,$.byteOffset,$.byteLength)}function v$($,J){return $<<32-J|$>>>J}var Uq=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function Wq($){return $<<24&4278190080|$<<8&16711680|$>>>8&65280|$>>>24&255}function Kq($){for(let J=0;J<$.length;J++)$[J]=Wq($[J]);return $}var V8=Uq?($)=>$:Kq,LJ=(()=>typeof Uint8Array.from([]).toHex==="function"&&typeof Uint8Array.fromHex==="function")(),Nq=Array.from({length:256},($,J)=>J.toString(16).padStart(2,"0"));function I0($){if(n($),LJ)return $.toHex();let J="";for(let Q=0;Q<$.length;Q++)J+=Nq[$[Q]];return J}var n$={_0:48,_9:57,A:65,F:70,a:97,f:102};function VJ($){if($>=n$._0&&$<=n$._9)return $-n$._0;if($>=n$.A&&$<=n$.F)return $-(n$.A-10);if($>=n$.a&&$<=n$.f)return $-(n$.a-10);return}function A0($){if(typeof $!=="string")throw new Error("hex string expected, got "+typeof $);if(LJ)return Uint8Array.fromHex($);let J=$.length,Q=J/2;if(J%2)throw new Error("hex string expected, got unpadded hex of length "+J);let q=new Uint8Array(Q);for(let X=0,Y=0;X<Q;X++,Y+=2){let Z=VJ($.charCodeAt(Y)),W=VJ($.charCodeAt(Y+1));if(Z===void 0||W===void 0){let G=$[Y]+$[Y+1];throw new Error('hex string expected, got non-hex character "'+G+'" at index '+Y)}q[X]=Z*16+W}return q}function t$(...$){let J=0;for(let q=0;q<$.length;q++){let X=$[q];n(X),J+=X.length}let Q=new Uint8Array(J);for(let q=0,X=0;q<$.length;q++){let Y=$[q];Q.set(Y,X),X+=Y.length}return Q}function a0($,J={}){let Q=(X,Y)=>$(Y).update(X).digest(),q=$(void 0);return Q.outputLen=q.outputLen,Q.blockLen=q.blockLen,Q.create=(X)=>$(X),Object.assign(Q,J),Object.freeze(Q)}function F0($=32){let J=typeof globalThis==="object"?globalThis.crypto:null;if(typeof J?.getRandomValues!=="function")throw new Error("crypto.getRandomValues must be defined");return J.getRandomValues(new Uint8Array($))}var P0=($)=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,$])});/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */var wJ=BigInt(0),EJ=BigInt(1);function V0($,J=""){if(typeof $!=="boolean"){let Q=J&&`"${J}" `;throw new Error(Q+"expected boolean, got type="+typeof $)}return $}function zq($){if(typeof $==="bigint"){if(!i0($))throw new Error("positive bigint expected, got "+$)}else a$($);return $}function jJ($){if(typeof $!=="string")throw new Error("hex string expected, got "+typeof $);return $===""?wJ:BigInt("0x"+$)}function TJ($){return jJ(I0($))}function B0($){return jJ(I0(o0(n($)).reverse()))}function B8($,J){a$(J),$=zq($);let Q=A0($.toString(16).padStart(J*2,"0"));if(Q.length!==J)throw new Error("number too large");return Q}function AJ($,J){return B8($,J).reverse()}function o0($){return Uint8Array.from($)}var i0=($)=>typeof $==="bigint"&&wJ<=$;function Oq($,J,Q){return i0($)&&i0(J)&&i0(Q)&&J<=$&&$<Q}function L8($,J,Q,q){if(!Oq(J,Q,q))throw new Error("expected valid "+$+": "+Q+" <= n < "+q+", got "+J)}var FJ=($)=>(EJ<<BigInt($))-EJ;function x0($,J={},Q={}){if(!$||typeof $!=="object")throw new Error("expected valid options object");function q(Y,Z,W){let G=$[Y];if(W&&G===void 0)return;let D=typeof G;if(D!==Z||G===null)throw new Error(`param "${Y}" is invalid: expected ${Z}, got ${D}`)}let X=(Y,Z)=>Object.entries(Y).forEach(([W,G])=>q(W,G,Z));X(J,!1),X(Q,!0)}function E8($){let J=new WeakMap;return(Q,...q)=>{let X=J.get(Q);if(X!==void 0)return X;let Y=$(Q,...q);return J.set(Q,Y),Y}}var r0=BigInt(4294967295),PJ=BigInt(32);function Dq($,J=!1){if(J)return{h:Number($&r0),l:Number($>>PJ&r0)};return{h:Number($>>PJ&r0)|0,l:Number($&r0)|0}}function s0($,J=!1){let Q=$.length,q=new Uint32Array(Q),X=new Uint32Array(Q);for(let Y=0;Y<Q;Y++){let{h:Z,l:W}=Dq($[Y],J);[q[Y],X[Y]]=[Z,W]}return[q,X]}var w8=($,J,Q)=>$>>>Q,j8=($,J,Q)=>$<<32-Q|J>>>Q,U0=($,J,Q)=>$>>>Q|J<<32-Q,W0=($,J,Q)=>$<<32-Q|J>>>Q,_0=($,J,Q)=>$<<64-Q|J>>>Q-32,S0=($,J,Q)=>$>>>Q-32|J<<64-Q;var xJ=($,J,Q)=>$<<Q|J>>>32-Q,_J=($,J,Q)=>J<<Q|$>>>32-Q,SJ=($,J,Q)=>J<<Q-32|$>>>64-Q,kJ=($,J,Q)=>$<<Q-32|J>>>64-Q;function b$($,J,Q,q){let X=(J>>>0)+(q>>>0);return{h:$+Q+(X/4294967296|0)|0,l:X|0}}var vJ=($,J,Q)=>($>>>0)+(J>>>0)+(Q>>>0),fJ=($,J,Q,q)=>J+Q+q+($/4294967296|0)|0,mJ=($,J,Q,q)=>($>>>0)+(J>>>0)+(Q>>>0)+(q>>>0),gJ=($,J,Q,q,X)=>J+Q+q+X+($/4294967296|0)|0,yJ=($,J,Q,q,X)=>($>>>0)+(J>>>0)+(Q>>>0)+(q>>>0)+(X>>>0),bJ=($,J,Q,q,X,Y)=>J+Q+q+X+Y+($/4294967296|0)|0;var Rq=BigInt(0),k0=BigInt(1),Cq=BigInt(2),Hq=BigInt(7),Iq=BigInt(256),Vq=BigInt(113),uJ=[],cJ=[],dJ=[];for(let $=0,J=k0,Q=1,q=0;$<24;$++){[Q,q]=[q,(2*Q+3*q)%5],uJ.push(2*(5*q+Q)),cJ.push(($+1)*($+2)/2%64);let X=Rq;for(let Y=0;Y<7;Y++)if(J=(J<<k0^(J>>Hq)*Vq)%Iq,J&Cq)X^=k0<<(k0<<BigInt(Y))-k0;dJ.push(X)}var lJ=s0(dJ,!0),Bq=lJ[0],Lq=lJ[1],hJ=($,J,Q)=>Q>32?SJ($,J,Q):xJ($,J,Q),pJ=($,J,Q)=>Q>32?kJ($,J,Q):_J($,J,Q);function Eq($,J=24){let Q=new Uint32Array(10);for(let q=24-J;q<24;q++){for(let Z=0;Z<10;Z++)Q[Z]=$[Z]^$[Z+10]^$[Z+20]^$[Z+30]^$[Z+40];for(let Z=0;Z<10;Z+=2){let W=(Z+8)%10,G=(Z+2)%10,D=Q[G],z=Q[G+1],V=hJ(D,z,1)^Q[W],j=pJ(D,z,1)^Q[W+1];for(let P=0;P<50;P+=10)$[Z+P]^=V,$[Z+P+1]^=j}let X=$[2],Y=$[3];for(let Z=0;Z<24;Z++){let W=cJ[Z],G=hJ(X,Y,W),D=pJ(X,Y,W),z=uJ[Z];X=$[z],Y=$[z+1],$[z]=G,$[z+1]=D}for(let Z=0;Z<50;Z+=10){for(let W=0;W<10;W++)Q[W]=$[Z+W];for(let W=0;W<10;W++)$[Z+W]^=~Q[(W+2)%10]&Q[(W+4)%10]}$[0]^=Bq[q],$[1]^=Lq[q]}y$(Q)}class T8{state;pos=0;posOut=0;finished=!1;state32;destroyed=!1;blockLen;suffix;outputLen;enableXOF=!1;rounds;constructor($,J,Q,q=!1,X=24){if(this.blockLen=$,this.suffix=J,this.outputLen=Q,this.enableXOF=q,this.rounds=X,a$(Q,"outputLen"),!(0<$&&$<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=BJ(this.state)}clone(){return this._cloneInto()}keccak(){V8(this.state32),Eq(this.state32,this.rounds),V8(this.state32),this.posOut=0,this.pos=0}update($){H0(this),n($);let{blockLen:J,state:Q}=this,q=$.length;for(let X=0;X<q;){let Y=Math.min(J-this.pos,q-X);for(let Z=0;Z<Y;Z++)Q[this.pos++]^=$[X++];if(this.pos===J)this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:$,suffix:J,pos:Q,blockLen:q}=this;if($[Q]^=J,(J&128)!==0&&Q===q-1)this.keccak();$[q-1]^=128,this.keccak()}writeInto($){H0(this,!1),n($),this.finish();let J=this.state,{blockLen:Q}=this;for(let q=0,X=$.length;q<X;){if(this.posOut>=Q)this.keccak();let Y=Math.min(Q-this.posOut,X-q);$.set(J.subarray(this.posOut,this.posOut+Y),q),this.posOut+=Y,q+=Y}return $}xofInto($){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto($)}xof($){return a$($),this.xofInto(new Uint8Array($))}digestInto($){if(l0($,this),this.finished)throw new Error("digest() was already called");return this.writeInto($),this.destroy(),$}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,y$(this.state)}_cloneInto($){let{blockLen:J,suffix:Q,outputLen:q,rounds:X,enableXOF:Y}=this;return $||=new T8(J,Q,q,Y,X),$.state32.set(this.state32),$.pos=this.pos,$.posOut=this.posOut,$.finished=this.finished,$.rounds=X,$.suffix=Q,$.outputLen=q,$.enableXOF=Y,$.destroyed=this.destroyed,$}}var nJ=($,J,Q,q={})=>a0((X={})=>new T8(J,$,X.dkLen===void 0?Q:X.dkLen,!0),q),aJ=nJ(31,168,16,P0(11)),j$=nJ(31,136,32,P0(12));function A8($){if(!Number.isSafeInteger($)||$<0||$>4294967295)throw new Error("wrong u32 integer:"+$);return $}function oJ($){return A8($),($&$-1)===0&&$!==0}function F8($,J){A8($);let Q=0;for(let q=0;q<J;q++,$>>>=1)Q=Q<<1|$&1;return Q}function rJ($){return A8($),31-Math.clz32($)}function iJ($){let J=$.length;if(J<2||!oJ(J))throw new Error("n must be a power of 2 and greater than 1. Got "+J);let Q=rJ(J);for(let q=0;q<J;q++){let X=F8(q,Q);if(q<X){let Y=$[q];$[q]=$[X],$[X]=Y}}return $}var P8=($,J)=>{let{N:Q,roots:q,dit:X,invertButterflies:Y=!1,skipStages:Z=0,brp:W=!0}=J,G=rJ(Q);if(!oJ(Q))throw new Error("FFT: Polynomial size should be power of two");let D=X!==Y;return(z)=>{if(z.length!==Q)throw new Error("FFT: wrong Polynomial length");if(X&&W)iJ(z);for(let V=0,j=1;V<G-Z;V++){let P=X?V+1+Z:G-V,T=1<<P,y=T>>1,E=Q>>P;for(let x=0;x<Q;x+=T)for(let C=0,R=j++;C<y;C++){let b=Y?X?Q-R:R:C*E,c=x+C,l=x+C+y,u=q[b],B=z[l],A=z[c];if(D){let v=$.mul(B,u);z[c]=$.add(A,v),z[l]=$.sub(A,v)}else if(Y)z[c]=$.add(B,A),z[l]=$.mul($.sub(B,A),u);else z[c]=$.add(A,B),z[l]=$.mul($.sub(A,B),u)}}if(!X&&W)iJ(z);return z}};/*! noble-post-quantum - MIT License (c) 2024 Paul Miller (paulmillr.com) */var x8=F0;function _8($,J){if($.length!==J.length)return!1;let Q=0;for(let q=0;q<$.length;q++)Q|=$[q]^J[q];return Q===0}function S8($){if(typeof $!=="object"||$===null||C0($))throw new Error("expected opts to be an object")}function t0($){if(S8($),$.context!==void 0)n($.context,void 0,"opts.context")}function e0($){if(t0($),$.extraEntropy!==!1&&$.extraEntropy!==void 0)n($.extraEntropy,void 0,"opts.extraEntropy")}function v0($,...J){let Q=(X)=>typeof X==="number"?X:X.bytesLen,q=J.reduce((X,Y)=>X+Q(Y),0);return{bytesLen:q,encode:(X)=>{let Y=new Uint8Array(q);for(let Z=0,W=0;Z<J.length;Z++){let G=J[Z],D=Q(G),z=typeof G==="number"?X[Z]:G.encode(X[Z]);if(n(z,D,$),Y.set(z,W),typeof G!=="number")z.fill(0);W+=D}return Y},decode:(X)=>{n(X,q,$);let Y=[];for(let Z of J){let W=Q(Z),G=X.subarray(0,W);Y.push(typeof Z==="number"?G:Z.decode(G)),X=X.subarray(W)}return Y}}}function K0($,J){let Q=J*$.bytesLen;return{bytesLen:Q,encode:(q)=>{if(q.length!==J)throw new Error(`vecCoder.encode: wrong length=${q.length}. Expected: ${J}`);let X=new Uint8Array(Q);for(let Y=0,Z=0;Y<q.length;Y++){let W=$.encode(q[Y]);X.set(W,Z),W.fill(0),Z+=W.length}return X},decode:(q)=>{n(q,Q);let X=[];for(let Y=0;Y<q.length;Y+=$.bytesLen)X.push($.decode(q.subarray(Y,Y+$.bytesLen)));return X}}}function h$(...$){for(let J of $)if(Array.isArray(J))for(let Q of J)Q.fill(0);else J.fill(0)}function k8($){return(1<<$)-1}var sJ=Uint8Array.of();function v8($,J=sJ){if(n($),n(J),J.length>255)throw new Error("context should be less than 255 bytes");return t$(new Uint8Array([0,J.length]),J,$)}var wq=Uint8Array.from([6,9,96,134,72,1,101,3,4,2]);function tJ($,J=0){if(!$.oid||!_8($.oid.subarray(0,10),wq))throw new Error("hash.oid is invalid: expected NIST hash");let Q=$.outputLen*8/2;if(J>Q)throw new Error("Pre-hash security strength too low: "+Q+", required: "+J)}function f8($,J,Q=sJ){if(n(J),n(Q),Q.length>255)throw new Error("context should be less than 255 bytes");let q=$(J);return t$(new Uint8Array([1,Q.length]),Q,$.oid,q)}/*! noble-post-quantum - MIT License (c) 2024 Paul Miller (paulmillr.com) */var eJ=($)=>{let{newPoly:J,N:Q,Q:q,F:X,ROOT_OF_UNITY:Y,brvBits:Z,isKyber:W}=$,G=(C,R=q)=>{let b=C%R|0;return(b>=0?b|0:R+b|0)|0},D=(C,R=q)=>{let b=G(C,R)|0;return(b>R>>1?b-R|0:b)|0};function z(){let C=J(Q);for(let R=0;R<Q;R++){let b=F8(R,Z),c=BigInt(Y)**BigInt(b)%BigInt(q);C[R]=Number(c)|0}return C}let V=z(),j={add:(C,R)=>G((C|0)+(R|0))|0,sub:(C,R)=>G((C|0)-(R|0))|0,mul:(C,R)=>G((C|0)*(R|0))|0,inv:(C)=>{throw new Error("not implemented")}},P={N:Q,roots:V,invertButterflies:!0,skipStages:W?1:0,brp:!1},T=P8(j,{dit:!1,...P}),y=P8(j,{dit:!0,...P});return{mod:G,smod:D,nttZetas:V,NTT:{encode:(C)=>{return T(C)},decode:(C)=>{y(C);for(let R=0;R<C.length;R++)C[R]=G(X*C[R]);return C}},bitsCoder:(C,R)=>{let b=k8(C),c=C*(Q/8);return{bytesLen:c,encode:(l)=>{let u=new Uint8Array(c);for(let B=0,A=0,v=0,i=0;B<l.length;B++){A|=(R.encode(l[B])&b)<<v,v+=C;for(;v>=8;v-=8,A>>=8)u[i++]=A&k8(v)}return u},decode:(l)=>{let u=J(Q);for(let B=0,A=0,v=0,i=0;B<l.length;B++){A|=l[B]<<v,v+=8;for(;v>=C;v-=C,A>>=C)u[i++]=R.decode(A&b)}return u}}}}},$Q=($)=>(J,Q)=>{if(!Q)Q=$.blockLen;let q=new Uint8Array(J.length+2);q.set(J);let X=J.length,Y=new Uint8Array(Q),Z=$.create({}),W=0,G=0;return{stats:()=>({calls:W,xofs:G}),get:(D,z)=>{return q[X+0]=D,q[X+1]=z,Z.destroy(),Z=$.create({}).update(q),W++,()=>{return G++,Z.xofInto(Y)}},clean:()=>{Z.destroy(),h$(Y,q)}}},$8=$Q(aJ),J8=$Q(j$);/*! noble-post-quantum - MIT License (c) 2024 Paul Miller (paulmillr.com) */function JQ($){if(S8($),$.externalMu!==void 0)V0($.externalMu,"opts.externalMu")}var $$=256,J0=8380417,jq=1753,Tq=8347681,z0=13,m8=Math.floor((J0-1)/88)|0,g8=Math.floor((J0-1)/32)|0,y8={2:{K:4,L:4,D:z0,GAMMA1:131072,GAMMA2:m8,TAU:39,ETA:2,OMEGA:80},3:{K:6,L:5,D:z0,GAMMA1:524288,GAMMA2:g8,TAU:49,ETA:4,OMEGA:55},5:{K:8,L:7,D:z0,GAMMA1:524288,GAMMA2:g8,TAU:60,ETA:2,OMEGA:75}},P$=($)=>new Int32Array($),{mod:N0,smod:q8,NTT:O$,bitsCoder:Aq}=eJ({N:$$,Q:J0,F:Tq,ROOT_OF_UNITY:jq,newPoly:P$,isKyber:!1,brvBits:8}),QQ=($)=>$,f0=($,J=QQ,Q=QQ)=>Aq($,{encode:(q)=>J(Q(q)),decode:(q)=>Q(J(q))}),e$=($,J)=>{for(let Q=0;Q<$.length;Q++)$[Q]=N0($[Q]+J[Q]);return $},qQ=($,J)=>{for(let Q=0;Q<$.length;Q++)$[Q]=N0($[Q]-J[Q]);return $},Fq=($)=>{for(let J=0;J<$$;J++)$[J]<<=z0;return $},m0=($,J)=>{for(let Q=0;Q<$$;Q++)if(Math.abs(q8($[Q]))>=J)return!0;return!1},$0=($,J)=>{let Q=P$($$);for(let q=0;q<$.length;q++)Q[q]=N0($[q]*J[q]);return Q};function Q8($){let J=P$($$);for(let Q=0;Q<$$;){let q=$();if(q.length%3)throw new Error("RejNTTPoly: unaligned block");for(let X=0;Q<$$&&X<=q.length-3;X+=3){let Y=(q[X+0]|q[X+1]<<8|q[X+2]<<16)&8388607;if(Y<J0)J[Q++]=Y}}return J}function b8($){let{K:J,L:Q,GAMMA1:q,GAMMA2:X,TAU:Y,ETA:Z,OMEGA:W}=$,{CRH_BYTES:G,TR_BYTES:D,C_TILDE_BYTES:z,XOF128:V,XOF256:j,securityLevel:P}=$;if(![2,4].includes(Z))throw new Error("Wrong ETA");if(![131072,524288].includes(q))throw new Error("Wrong GAMMA1");if(![m8,g8].includes(X))throw new Error("Wrong GAMMA2");let T=Y*Z,y=(w)=>{let f=N0(w),_=q8(f,2*X)|0;if(f-_===J0-1)return{r1:0,r0:_-1|0};return{r1:Math.floor((f-_)/(2*X))|0,r0:_}},E=(w)=>y(w).r1,x=(w)=>y(w).r0,C=(w,f)=>{return w<=X||w>J0-X||w===J0-X&&f===0?0:1},R=(w,f)=>{let _=Math.floor((J0-1)/(2*X)),{r1:k,r0:d}=y(f);if(w===1)return d>0?N0(k+1,_)|0:N0(k-1,_)|0;return k|0},b=(w)=>{let f=N0(w),_=q8(f,2**z0)|0;return{r1:Math.floor((f-_)/2**z0)|0,r0:_}},c={bytesLen:W+J,encode:(w)=>{if(w===!1)throw new Error("hint.encode: hint is false");let f=new Uint8Array(W+J);for(let _=0,k=0;_<J;_++){for(let d=0;d<$$;d++)if(w[_][d]!==0)f[k++]=d;f[W+_]=k}return f},decode:(w)=>{let f=[],_=0;for(let k=0;k<J;k++){let d=P$($$);if(w[W+k]<_||w[W+k]>W)return!1;for(let t=_;t<w[W+k];t++){if(t>_&&w[t]<=w[t-1])return!1;d[w[t]]=1}_=w[W+k],f.push(d)}for(let k=_;k<W;k++)if(w[k]!==0)return!1;return f}},l=f0(Z===2?3:4,(w)=>Z-w,(w)=>{if(!(-Z<=w&&w<=Z))throw new Error(`malformed key s1/s3 ${w} outside of ETA range [${-Z}, ${Z}]`);return w}),u=f0(13,(w)=>(1<<z0-1)-w),B=f0(10),A=f0(q===131072?18:20,(w)=>q8(q-w)),v=f0(X===m8?6:4),i=K0(v,J),s=v0("publicKey",32,K0(B,J)),K=v0("secretKey",32,32,D,K0(l,Q),K0(l,J),K0(u,J)),L=v0("signature",z,K0(A,Q),c),M=Z===2?(w)=>w<15?2-w%5:!1:(w)=>w<9?4-w:!1;function H(w){let f=P$($$);for(let _=0;_<$$;){let k=w();for(let d=0;_<$$&&d<k.length;d+=1){let t=M(k[d]&15),R$=M(k[d]>>4&15);if(t!==!1)f[_++]=t;if(_<$$&&R$!==!1)f[_++]=R$}}return f}let I=(w)=>{let f=P$($$),_=j$.create({}).update(w),k=new Uint8Array(j$.blockLen);_.xofInto(k);let d=k.slice(0,8);for(let t=$$-Y,R$=8,w$=0,G$=0;t<$$;t++){let U$=t+1;for(;U$>t;){if(U$=k[R$++],R$<j$.blockLen)continue;_.xofInto(k),R$=0}if(f[t]=f[U$],f[U$]=1-((d[w$]>>G$++&1)<<1),G$>=8)w$++,G$=0}return f},F=(w)=>{let f=P$($$),_=P$($$);for(let k=0;k<w.length;k++){let{r0:d,r1:t}=b(w[k]);f[k]=d,_[k]=t}return{r0:f,r1:_}},g=(w,f)=>{for(let _=0;_<$$;_++)w[_]=R(f[_],w[_]);return w},h=(w,f)=>{let _=P$($$),k=0;for(let d=0;d<$$;d++){let t=C(w[d],f[d]);_[d]=t,k+=t}return{v:_,cnt:k}},p=32,a=v0("seed",32,64,32),B$={info:{type:"internal-ml-dsa"},lengths:{secretKey:K.bytesLen,publicKey:s.bytesLen,seed:32,signature:L.bytesLen,signRand:p},keygen:(w)=>{let f=new Uint8Array(34),_=w===void 0;if(_)w=x8(32);if(n(w,32,"seed"),f.set(w),_)h$(w);f[32]=J,f[33]=Q;let[k,d,t]=a.decode(j$(f,{dkLen:a.bytesLen})),R$=j(d),w$=[];for(let m=0;m<Q;m++)w$.push(H(R$.get(m&255,m>>8&255)));let G$=[];for(let m=Q;m<Q+J;m++)G$.push(H(R$.get(m&255,m>>8&255)));let U$=w$.map((m)=>O$.encode(m.slice())),W$=[],C$=[],d$=V(k),z$=P$($$);for(let m=0;m<J;m++){h$(z$);for(let F$=0;F$<Q;F$++){let g$=Q8(d$.get(F$,m));e$(z$,$0(g$,U$[F$]))}O$.decode(z$);let{r0:_$,r1:A$}=F(e$(z$,G$[m]));W$.push(_$),C$.push(A$)}let m$=s.encode([k,C$]),l$=j$(m$,{dkLen:D}),R0=K.encode([k,t,l$,w$,G$,W$]);return d$.clean(),R$.clean(),h$(k,d,t,w$,G$,U$,z$,W$,C$,l$,f),{publicKey:m$,secretKey:R0}},getPublicKey:(w)=>{let[f,_,k,d,t,R$]=K.decode(w),w$=V(f),G$=d.map((C$)=>O$.encode(C$.slice())),U$=[],W$=P$($$);for(let C$=0;C$<J;C$++){W$.fill(0);for(let z$=0;z$<Q;z$++){let m$=Q8(w$.get(z$,C$));e$(W$,$0(m$,G$[z$]))}O$.decode(W$),e$(W$,t[C$]);let{r1:d$}=F(W$);U$.push(d$)}return w$.clean(),h$(W$,G$,R$,d,t),s.encode([f,U$])},sign:(w,f,_={})=>{e0(_),JQ(_);let{extraEntropy:k,externalMu:d=!1}=_,[t,R$,w$,G$,U$,W$]=K.decode(f),C$=[],d$=V(t);for(let m=0;m<J;m++){let _$=[];for(let A$=0;A$<Q;A$++)_$.push(Q8(d$.get(A$,m)));C$.push(_$)}d$.clean();for(let m=0;m<Q;m++)O$.encode(G$[m]);for(let m=0;m<J;m++)O$.encode(U$[m]),O$.encode(W$[m]);let z$=d?w:j$.create({dkLen:G}).update(w$).update(w).digest(),m$=k===!1?new Uint8Array(32):k===void 0?x8(p):k;n(m$,32,"extraEntropy");let l$=j$.create({dkLen:G}).update(R$).update(m$).update(z$).digest();n(l$,G);let R0=j(l$,A.bytesLen);$:for(let m=0;;){let _$=[];for(let e=0;e<Q;e++,m++)_$.push(A.decode(R0.get(m&255,m>>8)()));let A$=_$.map((e)=>O$.encode(e.slice())),F$=[];for(let e=0;e<J;e++){let T0=P$($$);for(let s$=0;s$<Q;s$++)e$(T0,$0(C$[e][s$],A$[s$]));O$.decode(T0),F$.push(T0)}let g$=F$.map((e)=>e.map(E)),j0=j$.create({dkLen:z}).update(z$).update(i.encode(g$)).digest(),c0=O$.encode(I(j0)),d0=G$.map((e)=>$0(e,c0));for(let e=0;e<Q;e++)if(e$(O$.decode(d0[e]),_$[e]),m0(d0[e],q-T))continue $;let DJ=0,I8=[];for(let e=0;e<J;e++){let T0=O$.decode($0(U$[e],c0)),s$=qQ(F$[e],T0).map(x);if(m0(s$,X-T))continue $;let MJ=O$.decode($0(W$[e],c0));if(m0(MJ,X))continue $;e$(s$,MJ);let RJ=h(s$,g$[e]);I8.push(RJ.v),DJ+=RJ.cnt}if(DJ>W)continue;R0.clean();let Jq=L.encode([j0,d0,I8]);return h$(j0,d0,I8,c0,g$,F$,A$,_$,l$,z$,G$,U$,W$,...C$),Jq}throw new Error("Unreachable code path reached, report this error")},verify:(w,f,_,k={})=>{JQ(k);let{externalMu:d=!1}=k,[t,R$]=s.decode(_),w$=j$(_,{dkLen:D});if(w.length!==L.bytesLen)return!1;let[G$,U$,W$]=L.decode(w);if(W$===!1)return!1;for(let m=0;m<Q;m++)if(m0(U$[m],q-T))return!1;let C$=d?f:j$.create({dkLen:G}).update(w$).update(f).digest(),d$=O$.encode(I(G$)),z$=U$.map((m)=>m.slice());for(let m=0;m<Q;m++)O$.encode(z$[m]);let m$=[],l$=V(t);for(let m=0;m<J;m++){let _$=$0(O$.encode(Fq(R$[m])),d$),A$=P$($$);for(let g$=0;g$<Q;g$++){let j0=Q8(l$.get(g$,m));e$(A$,$0(j0,z$[g$]))}let F$=O$.decode(qQ(A$,_$));m$.push(g(F$,W$[m]))}l$.clean();let R0=j$.create({dkLen:z}).update(C$).update(i.encode(m$)).digest();for(let m of W$)if(!(m.reduce((A$,F$)=>A$+F$,0)<=W))return!1;for(let m of U$)if(m0(m,q-T))return!1;return _8(G$,R0)}};return{info:{type:"ml-dsa"},internal:B$,securityLevel:P,keygen:B$.keygen,lengths:B$.lengths,getPublicKey:B$.getPublicKey,sign:(w,f,_={})=>{e0(_);let k=v8(w,_.context),d=B$.sign(k,f,_);return h$(k),d},verify:(w,f,_,k={})=>{return t0(k),B$.verify(w,v8(f,k.context),_)},prehash:(w)=>{return tJ(w,P),{info:{type:"hashml-dsa"},securityLevel:P,lengths:B$.lengths,keygen:B$.keygen,getPublicKey:B$.getPublicKey,sign:(f,_,k={})=>{e0(k);let d=f8(w,f,k.context),t=B$.sign(d,_,k);return h$(d),t},verify:(f,_,k,d={})=>{return t0(d),B$.verify(f,f8(w,_,d.context),k)}}}}}var XQ=b8({...y8[2],CRH_BYTES:64,TR_BYTES:64,C_TILDE_BYTES:32,XOF128:$8,XOF256:J8,securityLevel:128}),n9=b8({...y8[3],CRH_BYTES:64,TR_BYTES:64,C_TILDE_BYTES:48,XOF128:$8,XOF256:J8,securityLevel:192}),a9=b8({...y8[5],CRH_BYTES:64,TR_BYTES:64,C_TILDE_BYTES:64,XOF128:$8,XOF256:J8,securityLevel:256});function YQ($,J,Q){return $&J^~$&Q}function ZQ($,J,Q){return $&J^$&Q^J&Q}class X8{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor($,J,Q,q){this.blockLen=$,this.outputLen=J,this.padOffset=Q,this.isLE=q,this.buffer=new Uint8Array($),this.view=n0(this.buffer)}update($){H0(this),n($);let{view:J,buffer:Q,blockLen:q}=this,X=$.length;for(let Y=0;Y<X;){let Z=Math.min(q-this.pos,X-Y);if(Z===q){let W=n0($);for(;q<=X-Y;Y+=q)this.process(W,Y);continue}if(Q.set($.subarray(Y,Y+Z),this.pos),this.pos+=Z,Y+=Z,this.pos===q)this.process(J,0),this.pos=0}return this.length+=$.length,this.roundClean(),this}digestInto($){H0(this),l0($,this),this.finished=!0;let{buffer:J,view:Q,blockLen:q,isLE:X}=this,{pos:Y}=this;if(J[Y++]=128,y$(this.buffer.subarray(Y)),this.padOffset>q-Y)this.process(Q,0),Y=0;for(let z=Y;z<q;z++)J[z]=0;Q.setBigUint64(q-8,BigInt(this.length*8),X),this.process(Q,0);let Z=n0($),W=this.outputLen;if(W%4)throw new Error("_sha2: outputLen must be aligned to 32bit");let G=W/4,D=this.get();if(G>D.length)throw new Error("_sha2: outputLen bigger than state");for(let z=0;z<G;z++)Z.setUint32(4*z,D[z],X)}digest(){let{buffer:$,outputLen:J}=this;this.digestInto($);let Q=$.slice(0,J);return this.destroy(),Q}_cloneInto($){$||=new this.constructor,$.set(...this.get());let{blockLen:J,buffer:Q,length:q,finished:X,destroyed:Y,pos:Z}=this;if($.destroyed=Y,$.finished=X,$.length=q,$.pos=Z,q%J)$.buffer.set(Q);return $}clone(){return this._cloneInto()}}var i$=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),o$=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),D$=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),M$=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]);var Pq=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Q0=new Uint32Array(64);class h8 extends X8{constructor($){super(64,$,8,!1)}get(){let{A:$,B:J,C:Q,D:q,E:X,F:Y,G:Z,H:W}=this;return[$,J,Q,q,X,Y,Z,W]}set($,J,Q,q,X,Y,Z,W){this.A=$|0,this.B=J|0,this.C=Q|0,this.D=q|0,this.E=X|0,this.F=Y|0,this.G=Z|0,this.H=W|0}process($,J){for(let z=0;z<16;z++,J+=4)Q0[z]=$.getUint32(J,!1);for(let z=16;z<64;z++){let V=Q0[z-15],j=Q0[z-2],P=v$(V,7)^v$(V,18)^V>>>3,T=v$(j,17)^v$(j,19)^j>>>10;Q0[z]=T+Q0[z-7]+P+Q0[z-16]|0}let{A:Q,B:q,C:X,D:Y,E:Z,F:W,G,H:D}=this;for(let z=0;z<64;z++){let V=v$(Z,6)^v$(Z,11)^v$(Z,25),j=D+V+YQ(Z,W,G)+Pq[z]+Q0[z]|0,T=(v$(Q,2)^v$(Q,13)^v$(Q,22))+ZQ(Q,q,X)|0;D=G,G=W,W=Z,Z=Y+j|0,Y=X,X=q,q=Q,Q=j+T|0}Q=Q+this.A|0,q=q+this.B|0,X=X+this.C|0,Y=Y+this.D|0,Z=Z+this.E|0,W=W+this.F|0,G=G+this.G|0,D=D+this.H|0,this.set(Q,q,X,Y,Z,W,G,D)}roundClean(){y$(Q0)}destroy(){this.set(0,0,0,0,0,0,0,0),y$(this.buffer)}}class xq extends h8{A=i$[0]|0;B=i$[1]|0;C=i$[2]|0;D=i$[3]|0;E=i$[4]|0;F=i$[5]|0;G=i$[6]|0;H=i$[7]|0;constructor(){super(32)}}class _q extends h8{A=o$[0]|0;B=o$[1]|0;C=o$[2]|0;D=o$[3]|0;E=o$[4]|0;F=o$[5]|0;G=o$[6]|0;H=o$[7]|0;constructor(){super(28)}}var GQ=(()=>s0(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(($)=>BigInt($))))(),Sq=(()=>GQ[0])(),kq=(()=>GQ[1])(),q0=new Uint32Array(80),X0=new Uint32Array(80);class g0 extends X8{constructor($){super(128,$,16,!1)}get(){let{Ah:$,Al:J,Bh:Q,Bl:q,Ch:X,Cl:Y,Dh:Z,Dl:W,Eh:G,El:D,Fh:z,Fl:V,Gh:j,Gl:P,Hh:T,Hl:y}=this;return[$,J,Q,q,X,Y,Z,W,G,D,z,V,j,P,T,y]}set($,J,Q,q,X,Y,Z,W,G,D,z,V,j,P,T,y){this.Ah=$|0,this.Al=J|0,this.Bh=Q|0,this.Bl=q|0,this.Ch=X|0,this.Cl=Y|0,this.Dh=Z|0,this.Dl=W|0,this.Eh=G|0,this.El=D|0,this.Fh=z|0,this.Fl=V|0,this.Gh=j|0,this.Gl=P|0,this.Hh=T|0,this.Hl=y|0}process($,J){for(let C=0;C<16;C++,J+=4)q0[C]=$.getUint32(J),X0[C]=$.getUint32(J+=4);for(let C=16;C<80;C++){let R=q0[C-15]|0,b=X0[C-15]|0,c=U0(R,b,1)^U0(R,b,8)^w8(R,b,7),l=W0(R,b,1)^W0(R,b,8)^j8(R,b,7),u=q0[C-2]|0,B=X0[C-2]|0,A=U0(u,B,19)^_0(u,B,61)^w8(u,B,6),v=W0(u,B,19)^S0(u,B,61)^j8(u,B,6),i=mJ(l,v,X0[C-7],X0[C-16]),s=gJ(i,c,A,q0[C-7],q0[C-16]);q0[C]=s|0,X0[C]=i|0}let{Ah:Q,Al:q,Bh:X,Bl:Y,Ch:Z,Cl:W,Dh:G,Dl:D,Eh:z,El:V,Fh:j,Fl:P,Gh:T,Gl:y,Hh:E,Hl:x}=this;for(let C=0;C<80;C++){let R=U0(z,V,14)^U0(z,V,18)^_0(z,V,41),b=W0(z,V,14)^W0(z,V,18)^S0(z,V,41),c=z&j^~z&T,l=V&P^~V&y,u=yJ(x,b,l,kq[C],X0[C]),B=bJ(u,E,R,c,Sq[C],q0[C]),A=u|0,v=U0(Q,q,28)^_0(Q,q,34)^_0(Q,q,39),i=W0(Q,q,28)^S0(Q,q,34)^S0(Q,q,39),s=Q&X^Q&Z^X&Z,K=q&Y^q&W^Y&W;E=T|0,x=y|0,T=j|0,y=P|0,j=z|0,P=V|0,{h:z,l:V}=b$(G|0,D|0,B|0,A|0),G=Z|0,D=W|0,Z=X|0,W=Y|0,X=Q|0,Y=q|0;let L=vJ(A,i,K);Q=fJ(L,B,v,s),q=L|0}({h:Q,l:q}=b$(this.Ah|0,this.Al|0,Q|0,q|0)),{h:X,l:Y}=b$(this.Bh|0,this.Bl|0,X|0,Y|0),{h:Z,l:W}=b$(this.Ch|0,this.Cl|0,Z|0,W|0),{h:G,l:D}=b$(this.Dh|0,this.Dl|0,G|0,D|0),{h:z,l:V}=b$(this.Eh|0,this.El|0,z|0,V|0),{h:j,l:P}=b$(this.Fh|0,this.Fl|0,j|0,P|0),{h:T,l:y}=b$(this.Gh|0,this.Gl|0,T|0,y|0),{h:E,l:x}=b$(this.Hh|0,this.Hl|0,E|0,x|0),this.set(Q,q,X,Y,Z,W,G,D,z,V,j,P,T,y,E,x)}roundClean(){y$(q0,X0)}destroy(){y$(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class UQ extends g0{Ah=M$[0]|0;Al=M$[1]|0;Bh=M$[2]|0;Bl=M$[3]|0;Ch=M$[4]|0;Cl=M$[5]|0;Dh=M$[6]|0;Dl=M$[7]|0;Eh=M$[8]|0;El=M$[9]|0;Fh=M$[10]|0;Fl=M$[11]|0;Gh=M$[12]|0;Gl=M$[13]|0;Hh=M$[14]|0;Hl=M$[15]|0;constructor(){super(64)}}class vq extends g0{Ah=D$[0]|0;Al=D$[1]|0;Bh=D$[2]|0;Bl=D$[3]|0;Ch=D$[4]|0;Cl=D$[5]|0;Dh=D$[6]|0;Dl=D$[7]|0;Eh=D$[8]|0;El=D$[9]|0;Fh=D$[10]|0;Fl=D$[11]|0;Gh=D$[12]|0;Gl=D$[13]|0;Hh=D$[14]|0;Hl=D$[15]|0;constructor(){super(48)}}var H$=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),I$=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class fq extends g0{Ah=H$[0]|0;Al=H$[1]|0;Bh=H$[2]|0;Bl=H$[3]|0;Ch=H$[4]|0;Cl=H$[5]|0;Dh=H$[6]|0;Dl=H$[7]|0;Eh=H$[8]|0;El=H$[9]|0;Fh=H$[10]|0;Fl=H$[11]|0;Gh=H$[12]|0;Gl=H$[13]|0;Hh=H$[14]|0;Hl=H$[15]|0;constructor(){super(28)}}class mq extends g0{Ah=I$[0]|0;Al=I$[1]|0;Bh=I$[2]|0;Bl=I$[3]|0;Ch=I$[4]|0;Cl=I$[5]|0;Dh=I$[6]|0;Dl=I$[7]|0;Eh=I$[8]|0;El=I$[9]|0;Fh=I$[10]|0;Fl=I$[11]|0;Gh=I$[12]|0;Gl=I$[13]|0;Hh=I$[14]|0;Hl=I$[15]|0;constructor(){super(32)}}var WQ=a0(()=>new UQ,P0(3));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */var L$=BigInt(0),V$=BigInt(1),O0=BigInt(2),zQ=BigInt(3),OQ=BigInt(4),DQ=BigInt(5),gq=BigInt(7),MQ=BigInt(8),yq=BigInt(9),RQ=BigInt(16);function q$($,J){let Q=$%J;return Q>=L$?Q:J+Q}function f$($,J,Q){let q=$;while(J-- >L$)q*=q,q%=Q;return q}function KQ($,J){if($===L$)throw new Error("invert: expected non-zero number");if(J<=L$)throw new Error("invert: expected positive modulus, got "+J);let Q=q$($,J),q=J,X=L$,Y=V$,Z=V$,W=L$;while(Q!==L$){let D=q/Q,z=q%Q,V=X-Z*D,j=Y-W*D;q=Q,Q=z,X=Z,Y=W,Z=V,W=j}if(q!==V$)throw new Error("invert: does not exist");return q$(X,J)}function p8($,J,Q){if(!$.eql($.sqr(J),Q))throw new Error("Cannot find square root")}function CQ($,J){let Q=($.ORDER+V$)/OQ,q=$.pow(J,Q);return p8($,q,J),q}function bq($,J){let Q=($.ORDER-DQ)/MQ,q=$.mul(J,O0),X=$.pow(q,Q),Y=$.mul(J,X),Z=$.mul($.mul(Y,O0),X),W=$.mul(Y,$.sub(Z,$.ONE));return p8($,W,J),W}function hq($){let J=Z8($),Q=HQ($),q=Q(J,J.neg(J.ONE)),X=Q(J,q),Y=Q(J,J.neg(q)),Z=($+gq)/RQ;return(W,G)=>{let D=W.pow(G,Z),z=W.mul(D,q),V=W.mul(D,X),j=W.mul(D,Y),P=W.eql(W.sqr(z),G),T=W.eql(W.sqr(V),G);D=W.cmov(D,z,P),z=W.cmov(j,V,T);let y=W.eql(W.sqr(z),G),E=W.cmov(D,z,y);return p8(W,E,G),E}}function HQ($){if($<zQ)throw new Error("sqrt is not defined for small field");let J=$-V$,Q=0;while(J%O0===L$)J/=O0,Q++;let q=O0,X=Z8($);while(NQ(X,q)===1)if(q++>1000)throw new Error("Cannot find square root: probably non-prime P");if(Q===1)return CQ;let Y=X.pow(q,J),Z=(J+V$)/O0;return function W(G,D){if(G.is0(D))return D;if(NQ(G,D)!==1)throw new Error("Cannot find square root");let z=Q,V=G.mul(G.ONE,Y),j=G.pow(D,J),P=G.pow(D,Z);while(!G.eql(j,G.ONE)){if(G.is0(j))return G.ZERO;let T=1,y=G.sqr(j);while(!G.eql(y,G.ONE))if(T++,y=G.sqr(y),T===z)throw new Error("Cannot find square root");let E=V$<<BigInt(z-T-1),x=G.pow(V,E);z=T,V=G.sqr(x),j=G.mul(j,V),P=G.mul(P,x)}return P}}function pq($){if($%OQ===zQ)return CQ;if($%MQ===DQ)return bq;if($%RQ===yq)return hq($);return HQ($)}var IQ=($,J)=>(q$($,J)&V$)===V$,uq=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function VQ($){let J={ORDER:"bigint",BYTES:"number",BITS:"number"},Q=uq.reduce((q,X)=>{return q[X]="function",q},J);return x0($,Q),$}function cq($,J,Q){if(Q<L$)throw new Error("invalid exponent, negatives unsupported");if(Q===L$)return $.ONE;if(Q===V$)return J;let q=$.ONE,X=J;while(Q>L$){if(Q&V$)q=$.mul(q,X);X=$.sqr(X),Q>>=V$}return q}function Y8($,J,Q=!1){let q=new Array(J.length).fill(Q?$.ZERO:void 0),X=J.reduce((Z,W,G)=>{if($.is0(W))return Z;return q[G]=Z,$.mul(Z,W)},$.ONE),Y=$.inv(X);return J.reduceRight((Z,W,G)=>{if($.is0(W))return Z;return q[G]=$.mul(Z,q[G]),$.mul(Z,W)},Y),q}function NQ($,J){let Q=($.ORDER-V$)/O0,q=$.pow(J,Q),X=$.eql(q,$.ONE),Y=$.eql(q,$.ZERO),Z=$.eql(q,$.neg($.ONE));if(!X&&!Y&&!Z)throw new Error("invalid Legendre symbol result");return X?1:Y?0:-1}function dq($,J){if(J!==void 0)a$(J);let Q=J!==void 0?J:$.toString(2).length,q=Math.ceil(Q/8);return{nBitLength:Q,nByteLength:q}}class BQ{ORDER;BITS;BYTES;isLE;ZERO=L$;ONE=V$;_lengths;_sqrt;_mod;constructor($,J={}){if($<=L$)throw new Error("invalid field: expected ORDER > 0, got "+$);let Q=void 0;if(this.isLE=!1,J!=null&&typeof J==="object"){if(typeof J.BITS==="number")Q=J.BITS;if(typeof J.sqrt==="function")this.sqrt=J.sqrt;if(typeof J.isLE==="boolean")this.isLE=J.isLE;if(J.allowedLengths)this._lengths=J.allowedLengths?.slice();if(typeof J.modFromBytes==="boolean")this._mod=J.modFromBytes}let{nBitLength:q,nByteLength:X}=dq($,Q);if(X>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");this.ORDER=$,this.BITS=q,this.BYTES=X,this._sqrt=void 0,Object.preventExtensions(this)}create($){return q$($,this.ORDER)}isValid($){if(typeof $!=="bigint")throw new Error("invalid field element: expected bigint, got "+typeof $);return L$<=$&&$<this.ORDER}is0($){return $===L$}isValidNot0($){return!this.is0($)&&this.isValid($)}isOdd($){return($&V$)===V$}neg($){return q$(-$,this.ORDER)}eql($,J){return $===J}sqr($){return q$($*$,this.ORDER)}add($,J){return q$($+J,this.ORDER)}sub($,J){return q$($-J,this.ORDER)}mul($,J){return q$($*J,this.ORDER)}pow($,J){return cq(this,$,J)}div($,J){return q$($*KQ(J,this.ORDER),this.ORDER)}sqrN($){return $*$}addN($,J){return $+J}subN($,J){return $-J}mulN($,J){return $*J}inv($){return KQ($,this.ORDER)}sqrt($){if(!this._sqrt)this._sqrt=pq(this.ORDER);return this._sqrt(this,$)}toBytes($){return this.isLE?AJ($,this.BYTES):B8($,this.BYTES)}fromBytes($,J=!1){n($);let{_lengths:Q,BYTES:q,isLE:X,ORDER:Y,_mod:Z}=this;if(Q){if(!Q.includes($.length)||$.length>q)throw new Error("Field.fromBytes: expected "+Q+" bytes, got "+$.length);let G=new Uint8Array(q);G.set($,X?0:G.length-$.length),$=G}if($.length!==q)throw new Error("Field.fromBytes: expected "+q+" bytes, got "+$.length);let W=X?B0($):TJ($);if(Z)W=q$(W,Y);if(!J){if(!this.isValid(W))throw new Error("invalid field element: outside of range 0..ORDER")}return W}invertBatch($){return Y8(this,$)}cmov($,J,Q){return Q?J:$}}function Z8($,J={}){return new BQ($,J)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */var G8=BigInt(0),l8=BigInt(1);function LQ($,J){let Q=J.negate();return $?Q:J}function U8($,J){let Q=Y8($.Fp,J.map((q)=>q.Z));return J.map((q,X)=>$.fromAffine(q.toAffine(Q[X])))}function TQ($,J){if(!Number.isSafeInteger($)||$<=0||$>J)throw new Error("invalid window size, expected [1.."+J+"], got W="+$)}function u8($,J){TQ($,J);let Q=Math.ceil(J/$)+1,q=2**($-1),X=2**$,Y=FJ($),Z=BigInt($);return{windows:Q,windowSize:q,mask:Y,maxNumber:X,shiftBy:Z}}function EQ($,J,Q){let{windowSize:q,mask:X,maxNumber:Y,shiftBy:Z}=Q,W=Number($&X),G=$>>Z;if(W>q)W-=Y,G+=l8;let D=J*q,z=D+Math.abs(W)-1,V=W===0,j=W<0,P=J%2!==0;return{nextN:G,offset:z,isZero:V,isNeg:j,isNegF:P,offsetF:D}}var c8=new WeakMap,AQ=new WeakMap;function d8($){return AQ.get($)||1}function wQ($){if($!==G8)throw new Error("invalid wNAF")}class n8{BASE;ZERO;Fn;bits;constructor($,J){this.BASE=$.BASE,this.ZERO=$.ZERO,this.Fn=$.Fn,this.bits=J}_unsafeLadder($,J,Q=this.ZERO){let q=$;while(J>G8){if(J&l8)Q=Q.add(q);q=q.double(),J>>=l8}return Q}precomputeWindow($,J){let{windows:Q,windowSize:q}=u8(J,this.bits),X=[],Y=$,Z=Y;for(let W=0;W<Q;W++){Z=Y,X.push(Z);for(let G=1;G<q;G++)Z=Z.add(Y),X.push(Z);Y=Z.double()}return X}wNAF($,J,Q){if(!this.Fn.isValid(Q))throw new Error("invalid scalar");let q=this.ZERO,X=this.BASE,Y=u8($,this.bits);for(let Z=0;Z<Y.windows;Z++){let{nextN:W,offset:G,isZero:D,isNeg:z,isNegF:V,offsetF:j}=EQ(Q,Z,Y);if(Q=W,D)X=X.add(LQ(V,J[j]));else q=q.add(LQ(z,J[G]))}return wQ(Q),{p:q,f:X}}wNAFUnsafe($,J,Q,q=this.ZERO){let X=u8($,this.bits);for(let Y=0;Y<X.windows;Y++){if(Q===G8)break;let{nextN:Z,offset:W,isZero:G,isNeg:D}=EQ(Q,Y,X);if(Q=Z,G)continue;else{let z=J[W];q=q.add(D?z.negate():z)}}return wQ(Q),q}getPrecomputes($,J,Q){let q=c8.get(J);if(!q){if(q=this.precomputeWindow(J,$),$!==1){if(typeof Q==="function")q=Q(q);c8.set(J,q)}}return q}cached($,J,Q){let q=d8($);return this.wNAF(q,this.getPrecomputes(q,$,Q),J)}unsafe($,J,Q,q){let X=d8($);if(X===1)return this._unsafeLadder($,J,q);return this.wNAFUnsafe(X,this.getPrecomputes(X,$,Q),J,q)}createCache($,J){TQ(J,this.bits),AQ.set($,J),c8.delete($)}hasCache($){return d8($)!==1}}function jQ($,J,Q){if(J){if(J.ORDER!==$)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return VQ(J),J}else return Z8($,{isLE:Q})}function FQ($,J,Q={},q){if(q===void 0)q=$==="edwards";if(!J||typeof J!=="object")throw new Error(`expected valid ${$} CURVE object`);for(let G of["p","n","h"]){let D=J[G];if(!(typeof D==="bigint"&&D>G8))throw new Error(`CURVE.${G} must be positive bigint`)}let X=jQ(J.p,Q.Fp,q),Y=jQ(J.n,Q.Fn,q),W=["Gx","Gy","a",$==="weierstrass"?"b":"d"];for(let G of W)if(!X.isValid(J[G]))throw new Error(`CURVE.${G} must be valid field element of CURVE.Fp`);return J=Object.freeze(Object.assign({},J)),{CURVE:J,Fp:X,Fn:Y}}function PQ($,J){return function Q(q){let X=$(q);return{secretKey:X,publicKey:J(X)}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */var Y0=BigInt(0),K$=BigInt(1),a8=BigInt(2),lq=BigInt(8);function nq($,J,Q,q){let X=$.sqr(Q),Y=$.sqr(q),Z=$.add($.mul(J.a,X),Y),W=$.add($.ONE,$.mul(J.d,$.mul(X,Y)));return $.eql(Z,W)}function xQ($,J={}){let Q=FQ("edwards",$,J,J.FpFnLE),{Fp:q,Fn:X}=Q,Y=Q.CURVE,{h:Z}=Y;x0(J,{},{uvRatio:"function"});let W=a8<<BigInt(X.BYTES*8)-K$,G=(E)=>q.create(E),D=J.uvRatio||((E,x)=>{try{return{isValid:!0,value:q.sqrt(q.div(E,x))}}catch(C){return{isValid:!1,value:Y0}}});if(!nq(q,Y,Y.Gx,Y.Gy))throw new Error("bad curve params: generator point");function z(E,x,C=!1){let R=C?K$:Y0;return L8("coordinate "+E,x,R,W),x}function V(E){if(!(E instanceof T))throw new Error("EdwardsPoint expected")}let j=E8((E,x)=>{let{X:C,Y:R,Z:b}=E,c=E.is0();if(x==null)x=c?lq:q.inv(b);let l=G(C*x),u=G(R*x),B=q.mul(b,x);if(c)return{x:Y0,y:K$};if(B!==K$)throw new Error("invZ was invalid");return{x:l,y:u}}),P=E8((E)=>{let{a:x,d:C}=Y;if(E.is0())throw new Error("bad point: ZERO");let{X:R,Y:b,Z:c,T:l}=E,u=G(R*R),B=G(b*b),A=G(c*c),v=G(A*A),i=G(u*x),s=G(A*G(i+B)),K=G(v+G(C*G(u*B)));if(s!==K)throw new Error("bad point: equation left != right (1)");let L=G(R*b),M=G(c*l);if(L!==M)throw new Error("bad point: equation left != right (2)");return!0});class T{static BASE=new T(Y.Gx,Y.Gy,K$,G(Y.Gx*Y.Gy));static ZERO=new T(Y0,K$,K$,Y0);static Fp=q;static Fn=X;X;Y;Z;T;constructor(E,x,C,R){this.X=z("x",E),this.Y=z("y",x),this.Z=z("z",C,!0),this.T=z("t",R),Object.freeze(this)}static CURVE(){return Y}static fromAffine(E){if(E instanceof T)throw new Error("extended point not allowed");let{x,y:C}=E||{};return z("x",x),z("y",C),new T(x,C,K$,G(x*C))}static fromBytes(E,x=!1){let C=q.BYTES,{a:R,d:b}=Y;E=o0(n(E,C,"point")),V0(x,"zip215");let c=o0(E),l=E[C-1];c[C-1]=l&-129;let u=B0(c),B=x?W:q.ORDER;L8("point.y",u,Y0,B);let A=G(u*u),v=G(A-K$),i=G(b*A-R),{isValid:s,value:K}=D(v,i);if(!s)throw new Error("bad point: invalid y coordinate");let L=(K&K$)===K$,M=(l&128)!==0;if(!x&&K===Y0&&M)throw new Error("bad point: x=0 and x_0=1");if(M!==L)K=G(-K);return T.fromAffine({x:K,y:u})}static fromHex(E,x=!1){return T.fromBytes(A0(E),x)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(E=8,x=!0){if(y.createCache(this,E),!x)this.multiply(a8);return this}assertValidity(){P(this)}equals(E){V(E);let{X:x,Y:C,Z:R}=this,{X:b,Y:c,Z:l}=E,u=G(x*l),B=G(b*R),A=G(C*l),v=G(c*R);return u===B&&A===v}is0(){return this.equals(T.ZERO)}negate(){return new T(G(-this.X),this.Y,this.Z,G(-this.T))}double(){let{a:E}=Y,{X:x,Y:C,Z:R}=this,b=G(x*x),c=G(C*C),l=G(a8*G(R*R)),u=G(E*b),B=x+C,A=G(G(B*B)-b-c),v=u+c,i=v-l,s=u-c,K=G(A*i),L=G(v*s),M=G(A*s),H=G(i*v);return new T(K,L,H,M)}add(E){V(E);let{a:x,d:C}=Y,{X:R,Y:b,Z:c,T:l}=this,{X:u,Y:B,Z:A,T:v}=E,i=G(R*u),s=G(b*B),K=G(l*C*v),L=G(c*A),M=G((R+b)*(u+B)-i-s),H=L-K,I=L+K,F=G(s-x*i),g=G(M*H),h=G(I*F),p=G(M*F),a=G(H*I);return new T(g,h,a,p)}subtract(E){return this.add(E.negate())}multiply(E){if(!X.isValidNot0(E))throw new Error("invalid scalar: expected 1 <= sc < curve.n");let{p:x,f:C}=y.cached(this,E,(R)=>U8(T,R));return U8(T,[x,C])[0]}multiplyUnsafe(E,x=T.ZERO){if(!X.isValid(E))throw new Error("invalid scalar: expected 0 <= sc < curve.n");if(E===Y0)return T.ZERO;if(this.is0()||E===K$)return this;return y.unsafe(this,E,(C)=>U8(T,C),x)}isSmallOrder(){return this.multiplyUnsafe(Z).is0()}isTorsionFree(){return y.unsafe(this,Y.n).is0()}toAffine(E){return j(this,E)}clearCofactor(){if(Z===K$)return this;return this.multiplyUnsafe(Z)}toBytes(){let{x:E,y:x}=this.toAffine(),C=q.toBytes(x);return C[C.length-1]|=E&K$?128:0,C}toHex(){return I0(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}let y=new n8(T,X.BITS);return T.BASE.precompute(8),T}function _Q($,J,Q={}){if(typeof J!=="function")throw new Error('"hash" function param is required');x0(Q,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:q}=Q,{BASE:X,Fp:Y,Fn:Z}=$,W=Q.randomBytes||F0,G=Q.adjustScalarBytes||((B)=>B),D=Q.domain||((B,A,v)=>{if(V0(v,"phflag"),A.length||v)throw new Error("Contexts/pre-hash are not supported");return B});function z(B){return Z.create(B0(B))}function V(B){let A=R.secretKey;n(B,R.secretKey,"secretKey");let v=n(J(B),2*A,"hashedSecretKey"),i=G(v.slice(0,A)),s=v.slice(A,2*A),K=z(i);return{head:i,prefix:s,scalar:K}}function j(B){let{head:A,prefix:v,scalar:i}=V(B),s=X.multiply(i),K=s.toBytes();return{head:A,prefix:v,scalar:i,point:s,pointBytes:K}}function P(B){return j(B).pointBytes}function T(B=Uint8Array.of(),...A){let v=t$(...A);return z(J(D(v,n(B,void 0,"context"),!!q)))}function y(B,A,v={}){if(B=n(B,void 0,"message"),q)B=q(B);let{prefix:i,scalar:s,pointBytes:K}=j(A),L=T(v.context,i,B),M=X.multiply(L).toBytes(),H=T(v.context,M,K,B),I=Z.create(L+H*s);if(!Z.isValid(I))throw new Error("sign failed: invalid s");let F=t$(M,Z.toBytes(I));return n(F,R.signature,"result")}let E={zip215:!0};function x(B,A,v,i=E){let{context:s,zip215:K}=i,L=R.signature;if(B=n(B,L,"signature"),A=n(A,void 0,"message"),v=n(v,R.publicKey,"publicKey"),K!==void 0)V0(K,"zip215");if(q)A=q(A);let M=L/2,H=B.subarray(0,M),I=B0(B.subarray(M,L)),F,g,h;try{F=$.fromBytes(v,K),g=$.fromBytes(H,K),h=X.multiplyUnsafe(I)}catch(B$){return!1}if(!K&&F.isSmallOrder())return!1;let p=T(s,g.toBytes(),F.toBytes(),A);return g.add(F.multiplyUnsafe(p)).subtract(h).clearCofactor().is0()}let C=Y.BYTES,R={secretKey:C,publicKey:C,signature:2*C,seed:C};function b(B=W(R.seed)){return n(B,R.seed,"seed")}function c(B){return C0(B)&&B.length===Z.BYTES}function l(B,A){try{return!!$.fromBytes(B,A)}catch(v){return!1}}let u={getExtendedPublicKey:j,randomSecretKey:b,isValidSecretKey:c,isValidPublicKey:l,toMontgomery(B){let{y:A}=$.fromBytes(B),v=R.publicKey,i=v===32;if(!i&&v!==57)throw new Error("only defined for 25519 and 448");let s=i?Y.div(K$+A,K$-A):Y.div(A-K$,A+K$);return Y.toBytes(s)},toMontgomerySecret(B){let A=R.secretKey;n(B,A);let v=J(B.subarray(0,A));return G(v).subarray(0,A)}};return Object.freeze({keygen:PQ(b,P),getPublicKey:P,sign:y,verify:x,utils:u,Point:$,lengths:R})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */var aq=BigInt(1),SQ=BigInt(2);var iq=BigInt(5),oq=BigInt(8),i8=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),rq=(()=>({p:i8,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:oq,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")}))();function sq($){let J=BigInt(10),Q=BigInt(20),q=BigInt(40),X=BigInt(80),Y=i8,W=$*$%Y*$%Y,G=f$(W,SQ,Y)*W%Y,D=f$(G,aq,Y)*$%Y,z=f$(D,iq,Y)*D%Y,V=f$(z,J,Y)*z%Y,j=f$(V,Q,Y)*V%Y,P=f$(j,q,Y)*j%Y,T=f$(P,X,Y)*P%Y,y=f$(T,X,Y)*P%Y,E=f$(y,J,Y)*z%Y;return{pow_p_5_8:f$(E,SQ,Y)*$%Y,b2:W}}function tq($){return $[0]&=248,$[31]&=127,$[31]|=64,$}var kQ=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function eq($,J){let Q=i8,q=q$(J*J*J,Q),X=q$(q*q*J,Q),Y=sq($*X).pow_p_5_8,Z=q$($*q*Y,Q),W=q$(J*Z*Z,Q),G=Z,D=q$(Z*kQ,Q),z=W===$,V=W===q$(-$,Q),j=W===q$(-$*kQ,Q);if(z)Z=G;if(V||j)Z=D;if(IQ(Z,Q))Z=q$(-Z,Q);return{isValid:z||V,value:Z}}var $9=xQ(rq,{uvRatio:eq});function J9($){return _Q($9,WQ,Object.assign({adjustScalarBytes:tq},$))}var vQ=J9({});var o8;try{o8=new TextDecoder}catch($){}var S,M0,O=0;var bQ=[],Q9=105,q9=57342,X9=57343,fQ=57337;var mQ=6,L0={},y0=112810000,r$=16810000;var r8=bQ,s8=0,o={},Q$,N8,z8=0,h0=0,Y$,S$,X$=[],t8=[],T$,E$,b0,gQ={useRecords:!1,mapsAsObjects:!0},p0=!1,hQ=2;try{new Function("")}catch($){hQ=1/0}class Z0{constructor($){if($){if(($.keyMap||$._keyMap)&&!$.useRecords)$.useRecords=!1,$.mapsAsObjects=!0;if($.useRecords===!1&&$.mapsAsObjects===void 0)$.mapsAsObjects=!0;if($.getStructures)$.getShared=$.getStructures;if($.getShared&&!$.structures)($.structures=[]).uninitialized=!0;if($.keyMap){this.mapKey=new Map;for(let[J,Q]of Object.entries($.keyMap))this.mapKey.set(Q,J)}}Object.assign(this,$)}decodeKey($){return this.keyMap?this.mapKey.get($)||$:$}encodeKey($){return this.keyMap&&this.keyMap.hasOwnProperty($)?this.keyMap[$]:$}encodeKeys($){if(!this._keyMap)return $;let J=new Map;for(let[Q,q]of Object.entries($))J.set(this._keyMap.hasOwnProperty(Q)?this._keyMap[Q]:Q,q);return J}decodeKeys($){if(!this._keyMap||$.constructor.name!="Map")return $;if(!this._mapKey){this._mapKey=new Map;for(let[Q,q]of Object.entries(this._keyMap))this._mapKey.set(q,Q)}let J={};return $.forEach((Q,q)=>J[k$(this._mapKey.has(q)?this._mapKey.get(q):q)]=Q),J}mapDecode($,J){let Q=this.decode($);if(this._keyMap)switch(Q.constructor.name){case"Array":return Q.map((q)=>this.decodeKeys(q))}return Q}decode($,J){if(S)return dQ(()=>{return O8(),this?this.decode($,J):Z0.prototype.decode.call(gQ,$,J)});M0=J>-1?J:$.length,O=0,s8=0,h0=0,N8=null,r8=bQ,Y$=null,S=$;try{E$=$.dataView||($.dataView=new DataView($.buffer,$.byteOffset,$.byteLength))}catch(Q){if(S=null,$ instanceof Uint8Array)throw Q;throw new Error("Source must be a Uint8Array or Buffer but was a "+($&&typeof $=="object"?$.constructor.name:typeof $))}if(this instanceof Z0){if(o=this,T$=this.sharedValues&&(this.pack?new Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),this.structures)return Q$=this.structures,W8();else if(!Q$||Q$.length>0)Q$=[]}else{if(o=gQ,!Q$||Q$.length>0)Q$=[];T$=null}return W8()}decodeMultiple($,J){let Q,q=0;try{let X=$.length;p0=!0;let Y=this?this.decode($,X):XJ.decode($,X);if(J){if(J(Y)===!1)return;while(O<X)if(q=O,J(W8())===!1)return}else{Q=[Y];while(O<X)q=O,Q.push(W8());return Q}}catch(X){throw X.lastPosition=q,X.values=Q,X}finally{p0=!1,O8()}}}function W8(){try{let $=r();if(Y$){if(O>=Y$.postBundlePosition){let J=new Error("Unexpected bundle position");throw J.incomplete=!0,J}O=Y$.postBundlePosition,Y$=null}if(O==M0){if(Q$=null,S=null,S$)S$=null}else if(O>M0){let J=new Error("Unexpected end of CBOR data");throw J.incomplete=!0,J}else if(!p0)throw new Error("Data read, but end of buffer not reached");return $}catch($){if(O8(),$ instanceof RangeError||$.message.startsWith("Unexpected end of buffer"))$.incomplete=!0;throw $}}function r(){let $=S[O++],J=$>>5;if($=$&31,$>23)switch($){case 24:$=S[O++];break;case 25:if(J==7)return U9();$=E$.getUint16(O),O+=2;break;case 26:if(J==7){let Q=E$.getFloat32(O);if(o.useFloat32>2){let q=D8[(S[O]&127)<<1|S[O+1]>>7];return O+=4,(q*Q+(Q>0?0.5:-0.5)>>0)/q}return O+=4,Q}$=E$.getUint32(O),O+=4;break;case 27:if(J==7){let Q=E$.getFloat64(O);return O+=8,Q}if(J>1){if(E$.getUint32(O)>0)throw new Error("JavaScript does not support arrays, maps, or strings with length over 4294967295");$=E$.getUint32(O+4)}else if(o.int64AsNumber)$=E$.getUint32(O)*4294967296,$+=E$.getUint32(O+4);else $=E$.getBigUint64(O);O+=8;break;case 31:switch(J){case 2:case 3:throw new Error("Indefinite length not supported for byte or text strings");case 4:let Q=[],q,X=0;while((q=r())!=L0){if(X>=y0)throw new Error(`Array length exceeds ${y0}`);Q[X++]=q}return J==4?Q:J==3?Q.join(""):Buffer.concat(Q);case 5:let Y;if(o.mapsAsObjects){let Z={},W=0;if(o.keyMap)while((Y=r())!=L0){if(W++>=r$)throw new Error(`Property count exceeds ${r$}`);Z[k$(o.decodeKey(Y))]=r()}else while((Y=r())!=L0){if(W++>=r$)throw new Error(`Property count exceeds ${r$}`);Z[k$(Y)]=r()}return Z}else{if(b0)o.mapsAsObjects=!0,b0=!1;let Z=new Map;if(o.keyMap){let W=0;while((Y=r())!=L0){if(W++>=r$)throw new Error(`Map size exceeds ${r$}`);Z.set(o.decodeKey(Y),r())}}else{let W=0;while((Y=r())!=L0){if(W++>=r$)throw new Error(`Map size exceeds ${r$}`);Z.set(Y,r())}}return Z}case 7:return L0;default:throw new Error("Invalid major type for indefinite length "+J)}default:throw new Error("Unknown token "+$)}switch(J){case 0:return $;case 1:return~$;case 2:return G9($);case 3:if(h0>=O)return N8.slice(O-z8,(O+=$)-z8);if(h0==0&&M0<140&&$<32){let X=$<16?pQ($):Z9($);if(X!=null)return X}return Y9($);case 4:if($>=y0)throw new Error(`Array length exceeds ${y0}`);let Q=new Array($);for(let X=0;X<$;X++)Q[X]=r();return Q;case 5:if($>=r$)throw new Error(`Map size exceeds ${y0}`);if(o.mapsAsObjects){let X={};if(o.keyMap)for(let Y=0;Y<$;Y++)X[k$(o.decodeKey(r()))]=r();else for(let Y=0;Y<$;Y++)X[k$(r())]=r();return X}else{if(b0)o.mapsAsObjects=!0,b0=!1;let X=new Map;if(o.keyMap)for(let Y=0;Y<$;Y++)X.set(o.decodeKey(r()),r());else for(let Y=0;Y<$;Y++)X.set(r(),r());return X}case 6:if($>=fQ){let X=Q$[$&8191];if(X){if(!X.read)X.read=e8(X);return X.read()}if($<65536){if($==X9){let Y=w0(),Z=r(),W=r();JJ(Z,W);let G={};if(o.keyMap)for(let D=2;D<Y;D++){let z=o.decodeKey(W[D-2]);G[k$(z)]=r()}else for(let D=2;D<Y;D++){let z=W[D-2];G[k$(z)]=r()}return G}else if($==q9){let Y=w0(),Z=r();for(let W=2;W<Y;W++)JJ(Z++,r());return r()}else if($==fQ)return D9();if(o.getShared){if(qJ(),X=Q$[$&8191],X){if(!X.read)X.read=e8(X);return X.read()}}}}let q=X$[$];if(q)if(q.handlesRead)return q(r);else return q(r());else{let X=r();for(let Y=0;Y<t8.length;Y++){let Z=t8[Y]($,X);if(Z!==void 0)return Z}return new p$(X,$)}case 7:switch($){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 31:default:let X=(T$||D0())[$];if(X!==void 0)return X;throw new Error("Unknown token "+$)}default:if(isNaN($)){let X=new Error("Unexpected end of CBOR data");throw X.incomplete=!0,X}throw new Error("Unknown CBOR token "+$)}}var yQ=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function e8($){if(!$)throw new Error("Structure is required in record definition");function J(){let Q=S[O++];if(Q=Q&31,Q>23)switch(Q){case 24:Q=S[O++];break;case 25:Q=E$.getUint16(O),O+=2;break;case 26:Q=E$.getUint32(O),O+=4;break;default:throw new Error("Expected array header, but got "+S[O-1])}let q=this.compiledReader;while(q){if(q.propertyCount===Q)return q(r);q=q.next}if(this.slowReads++>=hQ){let Y=this.length==Q?this:this.slice(0,Q);if(q=o.keyMap?new Function("r","return {"+Y.map((Z)=>o.decodeKey(Z)).map((Z)=>yQ.test(Z)?k$(Z)+":r()":"["+JSON.stringify(Z)+"]:r()").join(",")+"}"):new Function("r","return {"+Y.map((Z)=>yQ.test(Z)?k$(Z)+":r()":"["+JSON.stringify(Z)+"]:r()").join(",")+"}"),this.compiledReader)q.next=this.compiledReader;return q.propertyCount=Q,this.compiledReader=q,q(r)}let X={};if(o.keyMap)for(let Y=0;Y<Q;Y++)X[k$(o.decodeKey(this[Y]))]=r();else for(let Y=0;Y<Q;Y++)X[k$(this[Y])]=r();return X}return $.slowReads=0,J}function k$($){if(typeof $==="string")return $==="__proto__"?"__proto_":$;if(typeof $==="number"||typeof $==="boolean"||typeof $==="bigint")return $.toString();if($==null)return $+"";throw new Error("Invalid property name type "+typeof $)}var Y9=$J;function $J($){let J;if($<16){if(J=pQ($))return J}if($>64&&o8)return o8.decode(S.subarray(O,O+=$));let Q=O+$,q=[];J="";while(O<Q){let X=S[O++];if((X&128)===0)q.push(X);else if((X&224)===192){let Y=S[O++]&63;q.push((X&31)<<6|Y)}else if((X&240)===224){let Y=S[O++]&63,Z=S[O++]&63;q.push((X&31)<<12|Y<<6|Z)}else if((X&248)===240){let Y=S[O++]&63,Z=S[O++]&63,W=S[O++]&63,G=(X&7)<<18|Y<<12|Z<<6|W;if(G>65535)G-=65536,q.push(G>>>10&1023|55296),G=56320|G&1023;q.push(G)}else q.push(X);if(q.length>=4096)J+=N$.apply(String,q),q.length=0}if(q.length>0)J+=N$.apply(String,q);return J}var N$=String.fromCharCode;function Z9($){let J=O,Q=new Array($);for(let q=0;q<$;q++){let X=S[O++];if((X&128)>0){O=J;return}Q[q]=X}return N$.apply(String,Q)}function pQ($){if($<4)if($<2)if($===0)return"";else{let J=S[O++];if((J&128)>1){O-=1;return}return N$(J)}else{let J=S[O++],Q=S[O++];if((J&128)>0||(Q&128)>0){O-=2;return}if($<3)return N$(J,Q);let q=S[O++];if((q&128)>0){O-=3;return}return N$(J,Q,q)}else{let J=S[O++],Q=S[O++],q=S[O++],X=S[O++];if((J&128)>0||(Q&128)>0||(q&128)>0||(X&128)>0){O-=4;return}if($<6)if($===4)return N$(J,Q,q,X);else{let Y=S[O++];if((Y&128)>0){O-=5;return}return N$(J,Q,q,X,Y)}else if($<8){let Y=S[O++],Z=S[O++];if((Y&128)>0||(Z&128)>0){O-=6;return}if($<7)return N$(J,Q,q,X,Y,Z);let W=S[O++];if((W&128)>0){O-=7;return}return N$(J,Q,q,X,Y,Z,W)}else{let Y=S[O++],Z=S[O++],W=S[O++],G=S[O++];if((Y&128)>0||(Z&128)>0||(W&128)>0||(G&128)>0){O-=8;return}if($<10)if($===8)return N$(J,Q,q,X,Y,Z,W,G);else{let D=S[O++];if((D&128)>0){O-=9;return}return N$(J,Q,q,X,Y,Z,W,G,D)}else if($<12){let D=S[O++],z=S[O++];if((D&128)>0||(z&128)>0){O-=10;return}if($<11)return N$(J,Q,q,X,Y,Z,W,G,D,z);let V=S[O++];if((V&128)>0){O-=11;return}return N$(J,Q,q,X,Y,Z,W,G,D,z,V)}else{let D=S[O++],z=S[O++],V=S[O++],j=S[O++];if((D&128)>0||(z&128)>0||(V&128)>0||(j&128)>0){O-=12;return}if($<14)if($===12)return N$(J,Q,q,X,Y,Z,W,G,D,z,V,j);else{let P=S[O++];if((P&128)>0){O-=13;return}return N$(J,Q,q,X,Y,Z,W,G,D,z,V,j,P)}else{let P=S[O++],T=S[O++];if((P&128)>0||(T&128)>0){O-=14;return}if($<15)return N$(J,Q,q,X,Y,Z,W,G,D,z,V,j,P,T);let y=S[O++];if((y&128)>0){O-=15;return}return N$(J,Q,q,X,Y,Z,W,G,D,z,V,j,P,T,y)}}}}}function G9($){return o.copyBuffers?Uint8Array.prototype.slice.call(S,O,O+=$):S.subarray(O,O+=$)}var uQ=new Float32Array(1),K8=new Uint8Array(uQ.buffer,0,4);function U9(){let $=S[O++],J=S[O++],Q=($&127)>>2;if(Q===31){if(J||$&3)return NaN;return $&128?-1/0:1/0}if(Q===0){let q=(($&3)<<8|J)/16777216;return $&128?-q:q}return K8[3]=$&128|(Q>>1)+56,K8[2]=($&7)<<5|J>>3,K8[1]=J<<5,K8[0]=0,uQ[0]}var RX=new Array(4096);class p${constructor($,J){this.value=$,this.tag=J}}X$[0]=($)=>{return new Date($)};X$[1]=($)=>{return new Date(Math.round($*1000))};X$[2]=($)=>{let J=BigInt(0);for(let Q=0,q=$.byteLength;Q<q;Q++)J=BigInt($[Q])+(J<<BigInt(8));return J};X$[3]=($)=>{return BigInt(-1)-X$[2]($)};X$[4]=($)=>{return+($[1]+"e"+$[0])};X$[5]=($)=>{return $[1]*Math.exp($[0]*Math.log(2))};var JJ=($,J)=>{$=$-57344;let Q=Q$[$];if(Q&&Q.isShared)(Q$.restoreStructures||(Q$.restoreStructures=[]))[$]=Q;Q$[$]=J,J.read=e8(J)};X$[Q9]=($)=>{let J=$.length,Q=$[1];JJ($[0],Q);let q={};for(let X=2;X<J;X++){let Y=Q[X-2];q[k$(Y)]=$[X]}return q};X$[14]=($)=>{if(Y$)return Y$[0].slice(Y$.position0,Y$.position0+=$);return new p$($,14)};X$[15]=($)=>{if(Y$)return Y$[1].slice(Y$.position1,Y$.position1+=$);return new p$($,15)};var W9={Error,RegExp};X$[27]=($)=>{return(W9[$[0]]||Error)($[1],$[2])};var cQ=($)=>{if(S[O++]!=132){let Q=new Error("Packed values structure must be followed by a 4 element array");if(S.length<O)Q.incomplete=!0;throw Q}let J=$();if(!J||!J.length){let Q=new Error("Packed values structure must be followed by a 4 element array");throw Q.incomplete=!0,Q}return T$=T$?J.concat(T$.slice(J.length)):J,T$.prefixes=$(),T$.suffixes=$(),$()};cQ.handlesRead=!0;X$[51]=cQ;X$[mQ]=($)=>{if(!T$)if(o.getShared)qJ();else return new p$($,mQ);if(typeof $=="number")return T$[16+($>=0?2*$:-2*$-1)];let J=new Error("No support for non-integer packed references yet");if($===void 0)J.incomplete=!0;throw J};X$[28]=($)=>{if(!S$)S$=new Map,S$.id=0;let J=S$.id++,Q=O,q=S[O],X;if(q>>5==4)X=[];else X={};let Y={target:X};S$.set(J,Y);let Z=$();if(Y.used){if(Object.getPrototypeOf(X)!==Object.getPrototypeOf(Z))O=Q,X=Z,S$.set(J,{target:X}),Z=$();return Object.assign(X,Z)}return Y.target=Z,Z};X$[28].handlesRead=!0;X$[29]=($)=>{let J=S$.get($);return J.used=!0,J.target};X$[258]=($)=>new Set($);(X$[259]=($)=>{if(o.mapsAsObjects)o.mapsAsObjects=!1,b0=!0;return $()}).handlesRead=!0;function E0($,J){if(typeof $==="string")return $+J;if($ instanceof Array)return $.concat(J);return Object.assign({},$,J)}function D0(){if(!T$)if(o.getShared)qJ();else throw new Error("No packed values available");return T$}var K9=1399353956;t8.push(($,J)=>{if($>=225&&$<=255)return E0(D0().prefixes[$-224],J);if($>=28704&&$<=32767)return E0(D0().prefixes[$-28672],J);if($>=1879052288&&$<=2147483647)return E0(D0().prefixes[$-1879048192],J);if($>=216&&$<=223)return E0(J,D0().suffixes[$-216]);if($>=27647&&$<=28671)return E0(J,D0().suffixes[$-27639]);if($>=1811940352&&$<=1879048191)return E0(J,D0().suffixes[$-1811939328]);if($==K9)return{packedValues:T$,structures:Q$.slice(0),version:J};if($==55799)return J});var N9=new Uint8Array(new Uint16Array([1]).buffer)[0]==1,QJ=[Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array=="undefined"?{name:"BigUint64Array"}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array=="undefined"?{name:"BigInt64Array"}:BigInt64Array,Float32Array,Float64Array],z9=[64,68,69,70,71,72,77,78,79,85,86];for(let $=0;$<QJ.length;$++)O9(QJ[$],z9[$]);function O9($,J){let Q="get"+$.name.slice(0,-5),q;if(typeof $==="function")q=$.BYTES_PER_ELEMENT;else $=null;for(let X=0;X<2;X++){if(!X&&q==1)continue;let Y=q==2?1:q==4?2:q==8?3:0;X$[X?J:J-4]=q==1||X==N9?(Z)=>{if(!$)throw new Error("Could not find typed array for code "+J);if(!o.copyBuffers){if(q===1||q===2&&!(Z.byteOffset&1)||q===4&&!(Z.byteOffset&3)||q===8&&!(Z.byteOffset&7))return new $(Z.buffer,Z.byteOffset,Z.byteLength>>Y)}return new $(Uint8Array.prototype.slice.call(Z,0).buffer)}:(Z)=>{if(!$)throw new Error("Could not find typed array for code "+J);let W=new DataView(Z.buffer,Z.byteOffset,Z.byteLength),G=Z.length>>Y,D=new $(G),z=W[Q];for(let V=0;V<G;V++)D[V]=z.call(W,V<<Y,X);return D}}}function D9(){let $=w0(),J=O+r();for(let q=2;q<$;q++){let X=w0();O+=X}let Q=O;return O=J,Y$=[$J(w0()),$J(w0())],Y$.position0=0,Y$.position1=0,Y$.postBundlePosition=O,O=Q,r()}function w0(){let $=S[O++]&31;if($>23)switch($){case 24:$=S[O++];break;case 25:$=E$.getUint16(O),O+=2;break;case 26:$=E$.getUint32(O),O+=4;break}return $}function qJ(){if(o.getShared){let $=dQ(()=>{return S=null,o.getShared()})||{},J=$.structures||[];if(o.sharedVersion=$.version,T$=o.sharedValues=$.packedValues,Q$===!0)o.structures=Q$=J;else Q$.splice.apply(Q$,[0,J.length].concat(J))}}function dQ($){let J=M0,Q=O,q=s8,X=z8,Y=h0,Z=N8,W=r8,G=S$,D=Y$,z=new Uint8Array(S.slice(0,M0)),V=Q$,j=o,P=p0,T=$();return M0=J,O=Q,s8=q,z8=X,h0=Y,N8=Z,r8=W,S$=G,Y$=D,S=z,p0=P,Q$=V,o=j,E$=new DataView(S.buffer,S.byteOffset,S.byteLength),T}function O8(){S=null,S$=null,Q$=null}var D8=new Array(147);for(let $=0;$<256;$++)D8[$]=+("1e"+Math.floor(45.15-$*0.30103));var XJ=new Z0({useRecords:!1}),M9=XJ.decode,R9=XJ.decodeMultiple;var M8;try{M8=new TextEncoder}catch($){}var WJ,sQ,C8=typeof globalThis==="object"&&globalThis.Buffer,u0=typeof C8!=="undefined",YJ=u0?C8.allocUnsafeSlow:Uint8Array,lQ=u0?C8:Uint8Array,nQ=256,aQ=u0?4294967296:2144337920;var ZJ,N,J$,U=0,G0,Z$=null,C9=61440,H9=/[\u0080-\uFFFF]/,x$=Symbol("record-id");class H8 extends Z0{constructor($){super($);this.offset=0;let J,Q,q,X,Y,Z;$=$||{};let W=lQ.prototype.utf8Write?function(K,L,M){return N.utf8Write(K,L,M)}:M8&&M8.encodeInto?function(K,L){return M8.encodeInto(K,N.subarray(L)).written}:!1,G=this,D=$.structures||$.saveStructures,z=$.maxSharedStructures;if(z==null)z=D?128:0;if(z>8190)throw new Error("Maximum maxSharedStructure is 8190");let V=$.sequential;if(V)z=0;if(!this.structures)this.structures=[];if(this.saveStructures)this.saveShared=this.saveStructures;let j,P,T=$.sharedValues,y;if(T){y=Object.create(null);for(let K=0,L=T.length;K<L;K++)y[T[K]]=K}let E=[],x=0,C=0;this.mapEncode=function(K,L){if(this._keyMap&&!this._mapped)switch(K.constructor.name){case"Array":K=K.map((M)=>this.encodeKeys(M));break}return this.encode(K,L)},this.encode=function(K,L){if(!N)N=new YJ(8192),J$=new DataView(N.buffer,0,8192),U=0;if(G0=N.length-10,G0-U<2048)N=new YJ(N.length),J$=new DataView(N.buffer,0,N.length),G0=N.length-10,U=0;else if(L===NJ)U=U+7&2147483640;if(Q=U,G.useSelfDescribedHeader)J$.setUint32(U,3654940416),U+=3;if(Z=G.structuredClone?new Map:null,G.bundleStrings&&typeof K!=="string")Z$=[],Z$.size=1/0;else Z$=null;if(q=G.structures,q){if(q.uninitialized){let H=G.getShared()||{};G.structures=q=H.structures||[],G.sharedVersion=H.version;let I=G.sharedValues=H.packedValues;if(I){y={};for(let F=0,g=I.length;F<g;F++)y[I[F]]=F}}let M=q.length;if(M>z&&!V)M=z;if(!q.transitions){q.transitions=Object.create(null);for(let H=0;H<M;H++){let I=q[H];if(!I)continue;let F,g=q.transitions;for(let h=0,p=I.length;h<p;h++){if(g[x$]===void 0)g[x$]=H;let a=I[h];if(F=g[a],!F)F=g[a]=Object.create(null);g=F}g[x$]=H|1048576}}if(!V)q.nextId=M}if(X)X=!1;if(Y=q||[],P=y,$.pack){let M=new Map;if(M.values=[],M.encoder=G,M.maxValues=$.maxPrivatePackedValues||(y?16:1/0),M.objectMap=y||!1,M.samplingPackedValues=j,R8(K,M),M.values.length>0){N[U++]=216,N[U++]=51,c$(4);let H=M.values;R(H),c$(0),c$(0),P=Object.create(y||null);for(let I=0,F=H.length;I<F;I++)P[H[I]]=I}}ZJ=L&UJ;try{if(ZJ)return;if(R(K),Z$)oQ(Q,R);if(G.offset=U,Z&&Z.idsToInsert){if(U+=Z.idsToInsert.length*2,U>G0)c(U);G.offset=U;let M=B9(N.subarray(Q,U),Z.idsToInsert);return Z=null,M}if(L&NJ)return N.start=Q,N.end=U,N;return N.subarray(Q,U)}finally{if(q){if(C<10)C++;if(q.length>z)q.length=z;if(x>1e4){if(q.transitions=null,C=0,x=0,E.length>0)E=[]}else if(E.length>0&&!V){for(let M=0,H=E.length;M<H;M++)E[M][x$]=void 0;E=[]}}if(X&&G.saveShared){if(G.structures.length>z)G.structures=G.structures.slice(0,z);let M=N.subarray(Q,U);if(G.updateSharedData()===!1)return G.encode(K);return M}if(L&w9)U=Q}},this.findCommonStringsToPack=()=>{if(j=new Map,!y)y=Object.create(null);return(K)=>{let L=K&&K.threshold||4,M=this.pack?K.maxPrivatePackedValues||16:0;if(!T)T=this.sharedValues=[];for(let[H,I]of j)if(I.count>L)y[H]=M++,T.push(H),X=!0;while(this.saveShared&&this.updateSharedData()===!1);j=null}};let R=(K)=>{if(U>G0)N=c(U);var L=typeof K,M;if(L==="string"){if(P){let g=P[K];if(g>=0){if(g<16)N[U++]=g+224;else if(N[U++]=198,g&1)R(15-g>>1);else R(g-16>>1);return}else if(j&&!$.pack){let h=j.get(K);if(h)h.count++;else j.set(K,{count:1})}}let H=K.length;if(Z$&&H>=4&&H<1024){if((Z$.size+=H)>C9){let h,p=(Z$[0]?Z$[0].length*3+Z$[1].length:0)+10;if(U+p>G0)N=c(U+p);if(N[U++]=217,N[U++]=223,N[U++]=249,N[U++]=Z$.position?132:130,N[U++]=26,h=U-Q,U+=4,Z$.position)oQ(Q,R);Z$=["",""],Z$.size=0,Z$.position=h}let g=H9.test(K);Z$[g?0:1]+=K,N[U++]=g?206:207,R(H);return}let I;if(H<32)I=1;else if(H<256)I=2;else if(H<65536)I=3;else I=5;let F=H*3;if(U+F>G0)N=c(U+F);if(H<64||!W){let g,h,p,a=U+I;for(g=0;g<H;g++)if(h=K.charCodeAt(g),h<128)N[a++]=h;else if(h<2048)N[a++]=h>>6|192,N[a++]=h&63|128;else if((h&64512)===55296&&((p=K.charCodeAt(g+1))&64512)===56320)h=65536+((h&1023)<<10)+(p&1023),g++,N[a++]=h>>18|240,N[a++]=h>>12&63|128,N[a++]=h>>6&63|128,N[a++]=h&63|128;else N[a++]=h>>12|224,N[a++]=h>>6&63|128,N[a++]=h&63|128;M=a-U-I}else M=W(K,U+I,F);if(M<24)N[U++]=96|M;else if(M<256){if(I<2)N.copyWithin(U+2,U+1,U+1+M);N[U++]=120,N[U++]=M}else if(M<65536){if(I<3)N.copyWithin(U+3,U+2,U+2+M);N[U++]=121,N[U++]=M>>8,N[U++]=M&255}else{if(I<5)N.copyWithin(U+5,U+3,U+3+M);N[U++]=122,J$.setUint32(U,M),U+=4}U+=M}else if(L==="number")if(!this.alwaysUseFloat&&K>>>0===K)if(K<24)N[U++]=K;else if(K<256)N[U++]=24,N[U++]=K;else if(K<65536)N[U++]=25,N[U++]=K>>8,N[U++]=K&255;else N[U++]=26,J$.setUint32(U,K),U+=4;else if(!this.alwaysUseFloat&&K>>0===K)if(K>=-24)N[U++]=31-K;else if(K>=-256)N[U++]=56,N[U++]=~K;else if(K>=-65536)N[U++]=57,J$.setUint16(U,~K),U+=2;else N[U++]=58,J$.setUint32(U,~K),U+=4;else{let H;if((H=this.useFloat32)>0&&K<4294967296&&K>=-2147483648){N[U++]=250,J$.setFloat32(U,K);let I;if(H<4||(I=K*D8[(N[U]&127)<<1|N[U+1]>>7])>>0===I){U+=4;return}else U--}N[U++]=251,J$.setFloat64(U,K),U+=8}else if(L==="object")if(!K)N[U++]=246;else{if(Z){let I=Z.get(K);if(I){if(N[U++]=216,N[U++]=29,N[U++]=25,!I.references){let F=Z.idsToInsert||(Z.idsToInsert=[]);I.references=[],F.push(I)}I.references.push(U-Q),U+=2;return}else Z.set(K,{offset:U-Q})}let H=K.constructor;if(H===Object)b(K);else if(H===Array){if(M=K.length,M<24)N[U++]=128|M;else c$(M);for(let I=0;I<M;I++)R(K[I])}else if(H===Map){if(this.mapsAsObjects?this.useTag259ForMaps!==!1:this.useTag259ForMaps)N[U++]=217,N[U++]=1,N[U++]=3;if(M=K.size,M<24)N[U++]=160|M;else if(M<256)N[U++]=184,N[U++]=M;else if(M<65536)N[U++]=185,N[U++]=M>>8,N[U++]=M&255;else N[U++]=186,J$.setUint32(U,M),U+=4;if(G.keyMap)for(let[I,F]of K)R(G.encodeKey(I)),R(F);else for(let[I,F]of K)R(I),R(F)}else{for(let I=0,F=WJ.length;I<F;I++){let g=sQ[I];if(K instanceof g){let h=WJ[I],p=h.tag;if(p==null)p=h.getTag&&h.getTag.call(this,K);if(p<24)N[U++]=192|p;else if(p<256)N[U++]=216,N[U++]=p;else if(p<65536)N[U++]=217,N[U++]=p>>8,N[U++]=p&255;else if(p>-1)N[U++]=218,J$.setUint32(U,p),U+=4;h.encode.call(this,K,R,c);return}}if(K[Symbol.iterator]){if(ZJ){let I=new Error("Iterable should be serialized as iterator");throw I.iteratorNotHandled=!0,I}N[U++]=159;for(let I of K)R(I);N[U++]=255;return}if(K[Symbol.asyncIterator]||GJ(K)){let I=new Error("Iterable/blob should be serialized as iterator");throw I.iteratorNotHandled=!0,I}if(this.useToJSON&&K.toJSON){let I=K.toJSON();if(I!==K)return R(I)}b(K)}}else if(L==="boolean")N[U++]=K?245:244;else if(L==="bigint"){if(K<BigInt(1)<<BigInt(64)&&K>=0)N[U++]=27,J$.setBigUint64(U,K);else if(K>-(BigInt(1)<<BigInt(64))&&K<0)N[U++]=59,J$.setBigUint64(U,-K-BigInt(1));else if(this.largeBigIntToFloat)N[U++]=251,J$.setFloat64(U,Number(K));else{if(K>=BigInt(0))N[U++]=194;else N[U++]=195,K=BigInt(-1)-K;let H=[];while(K)H.push(Number(K&BigInt(255))),K>>=BigInt(8);KJ(new Uint8Array(H.reverse()),c);return}U+=8}else if(L==="undefined")N[U++]=247;else throw new Error("Unknown type: "+L)},b=this.useRecords===!1?this.variableMapSize?(K)=>{let L=Object.keys(K),M=Object.values(K),H=L.length;if(H<24)N[U++]=160|H;else if(H<256)N[U++]=184,N[U++]=H;else if(H<65536)N[U++]=185,N[U++]=H>>8,N[U++]=H&255;else N[U++]=186,J$.setUint32(U,H),U+=4;let I;if(G.keyMap)for(let F=0;F<H;F++)R(G.encodeKey(L[F])),R(M[F]);else for(let F=0;F<H;F++)R(L[F]),R(M[F])}:(K)=>{N[U++]=185;let L=U-Q;U+=2;let M=0;if(G.keyMap){for(let H in K)if(typeof K.hasOwnProperty!=="function"||K.hasOwnProperty(H))R(G.encodeKey(H)),R(K[H]),M++}else for(let H in K)if(typeof K.hasOwnProperty!=="function"||K.hasOwnProperty(H))R(H),R(K[H]),M++;N[L+++Q]=M>>8,N[L+Q]=M&255}:(K,L)=>{let M,H=Y.transitions||(Y.transitions=Object.create(null)),I=0,F=0,g,h;if(this.keyMap){h=Object.keys(K).map((a)=>this.encodeKey(a)),F=h.length;for(let a=0;a<F;a++){let B$=h[a];if(M=H[B$],!M)M=H[B$]=Object.create(null),I++;H=M}}else for(let a in K)if(typeof K.hasOwnProperty!=="function"||K.hasOwnProperty(a)){if(M=H[a],!M){if(H[x$]&1048576)g=H[x$]&65535;M=H[a]=Object.create(null),I++}H=M,F++}let p=H[x$];if(p!==void 0)p&=65535,N[U++]=217,N[U++]=p>>8|224,N[U++]=p&255;else{if(!h)h=H.__keys__||(H.__keys__=Object.keys(K));if(g===void 0){if(p=Y.nextId++,!p)p=0,Y.nextId=1;if(p>=nQ)Y.nextId=(p=z)+1}else p=g;if(Y[p]=h,p<z){N[U++]=217,N[U++]=p>>8|224,N[U++]=p&255,H=Y.transitions;for(let a=0;a<F;a++){if(H[x$]===void 0||H[x$]&1048576)H[x$]=p;H=H[h[a]]}H[x$]=p|1048576,X=!0}else{if(H[x$]=p,J$.setUint32(U,3655335680),U+=3,I)x+=C*I;if(E.length>=nQ-z)E.shift()[x$]=void 0;if(E.push(H),c$(F+2),R(57344+p),R(h),L)return;for(let a in K)if(typeof K.hasOwnProperty!=="function"||K.hasOwnProperty(a))R(K[a]);return}}if(F<24)N[U++]=128|F;else c$(F);if(L)return;for(let a in K)if(typeof K.hasOwnProperty!=="function"||K.hasOwnProperty(a))R(K[a])},c=(K)=>{let L;if(K>16777216){if(K-Q>aQ)throw new Error("Encoded buffer would be larger than maximum buffer size");L=Math.min(aQ,Math.round(Math.max((K-Q)*(K>67108864?1.25:2),4194304)/4096)*4096)}else L=(Math.max(K-Q<<2,N.length-1)>>12)+1<<12;let M=new YJ(L);if(J$=new DataView(M.buffer,0,L),N.copy)N.copy(M,0,Q,K);else M.set(N.slice(Q,K));return U-=Q,Q=0,G0=M.length-10,N=M},l=100,u=1000;this.encodeAsIterable=function(K,L){return i(K,L,B)},this.encodeAsAsyncIterable=function(K,L){return i(K,L,s)};function*B(K,L,M){let H=K.constructor;if(H===Object){let I=G.useRecords!==!1;if(I)b(K,!0);else iQ(Object.keys(K).length,160);for(let F in K){let g=K[F];if(!I)R(F);if(g&&typeof g==="object")if(L[F])yield*B(g,L[F]);else yield*A(g,L,F);else R(g)}}else if(H===Array){let I=K.length;c$(I);for(let F=0;F<I;F++){let g=K[F];if(g&&(typeof g==="object"||U-Q>l))if(L.element)yield*B(g,L.element);else yield*A(g,L,"element");else R(g)}}else if(K[Symbol.iterator]&&!K.buffer){N[U++]=159;for(let I of K)if(I&&(typeof I==="object"||U-Q>l))if(L.element)yield*B(I,L.element);else yield*A(I,L,"element");else R(I);N[U++]=255}else if(GJ(K))iQ(K.size,64),yield N.subarray(Q,U),yield K,v();else if(K[Symbol.asyncIterator])N[U++]=159,yield N.subarray(Q,U),yield K,v(),N[U++]=255;else R(K);if(M&&U>Q)yield N.subarray(Q,U);else if(U-Q>l)yield N.subarray(Q,U),v()}function*A(K,L,M){let H=U-Q;try{if(R(K),U-Q>l)yield N.subarray(Q,U),v()}catch(I){if(I.iteratorNotHandled)L[M]={},U=Q+H,yield*B.call(this,K,L[M]);else throw I}}function v(){l=u,G.encode(null,UJ)}function i(K,L,M){if(L&&L.chunkThreshold)l=u=L.chunkThreshold;else l=100;if(K&&typeof K==="object")return G.encode(null,UJ),M(K,G.iterateProperties||(G.iterateProperties={}),!0);return[G.encode(K)]}async function*s(K,L){for(let M of B(K,L,!0)){let H=M.constructor;if(H===lQ||H===Uint8Array)yield M;else if(GJ(M)){let I=M.stream().getReader(),F;while(!(F=await I.read()).done)yield F.value}else if(M[Symbol.asyncIterator])for await(let I of M)if(v(),I)yield*s(I,L.async||(L.async={}));else yield G.encode(I);else yield M}}}useBuffer($){N=$,J$=new DataView(N.buffer,N.byteOffset,N.byteLength),U=0}clearSharedData(){if(this.structures)this.structures=[];if(this.sharedValues)this.sharedValues=void 0}updateSharedData(){let $=this.sharedVersion||0;this.sharedVersion=$+1;let J=this.structures.slice(0),Q=new zJ(J,this.sharedValues,this.sharedVersion),q=this.saveShared(Q,(X)=>(X&&X.version||0)==$);if(q===!1)Q=this.getShared()||{},this.structures=Q.structures||[],this.sharedValues=Q.packedValues,this.sharedVersion=Q.version,this.structures.nextId=this.structures.length;else J.forEach((X,Y)=>this.structures[Y]=X);return q}}function iQ($,J){if($<24)N[U++]=J|$;else if($<256)N[U++]=J|24,N[U++]=$;else if($<65536)N[U++]=J|25,N[U++]=$>>8,N[U++]=$&255;else N[U++]=J|26,J$.setUint32(U,$),U+=4}class zJ{constructor($,J,Q){this.structures=$,this.packedValues=J,this.version=Q}}function c$($){if($<24)N[U++]=128|$;else if($<256)N[U++]=152,N[U++]=$;else if($<65536)N[U++]=153,N[U++]=$>>8,N[U++]=$&255;else N[U++]=154,J$.setUint32(U,$),U+=4}var I9=typeof Blob==="undefined"?function(){}:Blob;function GJ($){if($ instanceof I9)return!0;let J=$[Symbol.toStringTag];return J==="Blob"||J==="File"}function R8($,J){switch(typeof $){case"string":if($.length>3){if(J.objectMap[$]>-1||J.values.length>=J.maxValues)return;let q=J.get($);if(q){if(++q.count==2)J.values.push($)}else if(J.set($,{count:1}),J.samplingPackedValues){let X=J.samplingPackedValues.get($);if(X)X.count++;else J.samplingPackedValues.set($,{count:1})}}break;case"object":if($)if($ instanceof Array)for(let q=0,X=$.length;q<X;q++)R8($[q],J);else{let q=!J.encoder.useRecords;for(var Q in $)if($.hasOwnProperty(Q)){if(q)R8(Q,J);R8($[Q],J)}}break;case"function":console.log($)}}var V9=new Uint8Array(new Uint16Array([1]).buffer)[0]==1;sQ=[Date,Set,Error,RegExp,p$,ArrayBuffer,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array=="undefined"?function(){}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array=="undefined"?function(){}:BigInt64Array,Float32Array,Float64Array,zJ];WJ=[{tag:1,encode($,J){let Q=$.getTime()/1000;if((this.useTimestamp32||$.getMilliseconds()===0)&&Q>=0&&Q<4294967296)N[U++]=26,J$.setUint32(U,Q),U+=4;else N[U++]=251,J$.setFloat64(U,Q),U+=8}},{tag:258,encode($,J){let Q=Array.from($);J(Q)}},{tag:27,encode($,J){J([$.name,$.message])}},{tag:27,encode($,J){J(["RegExp",$.source,$.flags])}},{getTag($){return $.tag},encode($,J){J($.value)}},{encode($,J,Q){KJ($,Q)}},{getTag($){if($.constructor===Uint8Array){if(this.tagUint8Array||u0&&this.tagUint8Array!==!1)return 64}},encode($,J,Q){KJ($,Q)}},u$(68,1),u$(69,2),u$(70,4),u$(71,8),u$(72,1),u$(77,2),u$(78,4),u$(79,8),u$(85,4),u$(86,8),{encode($,J){let Q=$.packedValues||[],q=$.structures||[];if(Q.values.length>0){N[U++]=216,N[U++]=51,c$(4);let X=Q.values;J(X),c$(0),c$(0),packedObjectMap=Object.create(sharedPackedObjectMap||null);for(let Y=0,Z=X.length;Y<Z;Y++)packedObjectMap[X[Y]]=Y}if(q){J$.setUint32(U,3655335424),U+=3;let X=q.slice(0);X.unshift(57344),X.push(new p$($.version,1399353956)),J(X)}else J(new p$($.version,1399353956))}}];function u$($,J){if(!V9&&J>1)$-=4;return{tag:$,encode:function Q(q,X){let Y=q.byteLength,Z=q.byteOffset||0,W=q.buffer||q;X(u0?C8.from(W,Z,Y):new Uint8Array(W,Z,Y))}}}function KJ($,J){let Q=$.byteLength;if(Q<24)N[U++]=64+Q;else if(Q<256)N[U++]=88,N[U++]=Q;else if(Q<65536)N[U++]=89,N[U++]=Q>>8,N[U++]=Q&255;else N[U++]=90,J$.setUint32(U,Q),U+=4;if(U+Q>=N.length)J(U+Q);N.set($.buffer?$:new Uint8Array($),U),U+=Q}function B9($,J){let Q,q=J.length*2,X=$.length-q;J.sort((Y,Z)=>Y.offset>Z.offset?1:-1);for(let Y=0;Y<J.length;Y++){let Z=J[Y];Z.id=Y;for(let W of Z.references)$[W++]=Y>>8,$[W]=Y&255}while(Q=J.pop()){let Y=Q.offset;$.copyWithin(Y+q,Y,X),q-=2;let Z=Y+q;$[Z++]=216,$[Z++]=28,X=Y}return $}function oQ($,J){J$.setUint32(Z$.position+$,U-Z$.position-$+1);let Q=Z$;Z$=null,J(Q[0]),J(Q[1])}var OJ=new H8({useRecords:!1}),tQ=OJ.encode,L9=OJ.encodeAsIterable,E9=OJ.encodeAsAsyncIterable;var NJ=512,w9=1024,UJ=2048;async function $q($){try{let J=$.proof;if(!Array.isArray(J))throw new Error("VC has no proofs or invalid format.");let Q={...$};delete Q.proof;let q=eQ.default(Q);if(!q)throw new Error("Canonicalization failed during verification");let X=new TextEncoder().encode(q),Y=J.find((G)=>G.type==="Ed25519Signature2020"),Z=J.find((G)=>G.cryptosuite==="ml-dsa-44-2025"),W={ed25519:!1,pqc:!1};if(Y){let G=Y.verificationMethod||"",D="";if(G.includes("ed25519"))D=G.split("#")[1]||"";else D=G.split("#")[1]||"";let z=Y.proofValue;if(D&&z){let V=Uint8Array.from(Buffer.from(D,"hex"));W.ed25519=vQ.verify(z,X,V)}}if(Z){let D=(Z.verificationMethod||"").split("#")[1],z=Z.proofValue;if(D&&z){let V=Uint8Array.from(Buffer.from(z,"hex")),j=Uint8Array.from(Buffer.from(D,"hex"));W.pqc=XQ.verify(V,X,j)}}return{isValid:W.ed25519&&W.pqc,checks:W,decoded:Q}}catch(J){return{isValid:!1,checks:{ed25519:!1,pqc:!1},error:J.message}}}document.addEventListener("DOMContentLoaded",()=>{let $=document.getElementById("drop-zone"),J=document.getElementById("result-area");if(!$||!J)return;$.addEventListener("dragover",(Y)=>{Y.preventDefault(),$.classList.add("active")}),$.addEventListener("dragleave",()=>{$.classList.remove("active")}),$.addEventListener("drop",async(Y)=>{Y.preventDefault(),$.classList.remove("active");let Z=Y.dataTransfer?.files[0];if(Z)await q(Z)});let Q=document.getElementById("file-input");if(Q)Q.addEventListener("change",async(Y)=>{let Z=Y.target.files[0];if(Z)await q(Z)});async function q(Y){J.innerHTML='<div class="scanning">Reading VC file...</div>';try{let Z=await Y.text(),W=JSON.parse(Z);J.innerHTML='<div class="scanning">Verifying Signatures (Ed25519 + ML-DSA-44)...</div>',await new Promise((D)=>setTimeout(D,600));let G=await $q(W);if(G.isValid){J.innerHTML='<div class="scanning">Checking Revocation Status...</div>';try{let z=await fetch("status-list.json");if(z.ok){let j=(await z.json()).credentialSubject?.["srn:revokedBuildIds"]||[],P=W.credentialSubject?.["srn:buildId"];if(P&&j.includes(P))G.isValid=!1,G.revocationError=`REVOKED: Build ID '${P}' is in the revocation list.`}else console.warn("Could not fetch status list")}catch(D){console.warn("Revocation check failed (Network error?)",D)}}X(G,W)}catch(Z){J.innerHTML=`<div class="error">Failed to parse VC: ${Z.message}</div>`}}function X(Y,Z){let W=Y.isValid,G=W?"#27ae60":"#c0392b",D=W?"\uD83D\uDEE1 VALID":" INVALID",z="";if(Y.revocationError)W=!1,G="#d32f2f",D=" REVOKED",z=`<div style="background: #ffebee; color: #c62828; padding: 1rem; border-radius: 4px; margin: 1rem 0; font-weight: bold;">
                ${Y.revocationError}
            </div>`;let V=`
            <div style="border: 2px solid ${G}; padding: 2rem; border-radius: 8px; background: #fff;">
                <h2 style="color: ${G}; margin-top: 0; font-size: 2rem;">${D}</h2>
                ${z}
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1.5rem 0;">
                    <div class="check-item ${Y.checks.ed25519?"pass":"fail"}">
                        <strong>Ed25519 (Classic)</strong>
                        <span>${Y.checks.ed25519?"P-256 Signature Verified":"Verification Failed"}</span>
                    </div>
                    <div class="check-item ${Y.checks.pqc?"pass":"fail"}">
                        <strong>ML-DSA-44 (Post-Quantum)</strong>
                        <span>${Y.checks.pqc?"Lattice-based Signature Verified":"Verification Failed"}</span>
                    </div>
                </div>

                <details style="margin-top: 1rem; border-top: 1px solid #eee; padding-top: 1rem;">
                    <summary style="cursor: pointer; color: #666;">View Raw VC Payload</summary>
                    <pre style="background: #f8f8f8; padding: 1rem; overflow: auto; text-align: left; font-size: 0.8rem;">${JSON.stringify(Z,null,2)}</pre>
                </details>
            </div>
        `;J.innerHTML=V}});
