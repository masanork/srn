<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline'; font-src 'self' data:; img-src 'self' data:; worker-src 'self' blob:; connect-src 'self';">
    <title>Glyph Search</title>
    <link rel="icon" href="data:,">
    <link rel="stylesheet" href="style.css">
    <link rel="sitemap" type="application/xml" href="/sitemap.xml">
    <link rel="help" type="text/plain" href="/llms.txt">
    
<style>
@font-face {
  font-family: 'ipamjm';
  src: url('data:font/woff2;base64,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') format('woff2');
  font-display: swap;
}
</style>
                    
<style>
@font-face {
  font-family: 'acgjm';
  src: url('data:font/woff2;base64,d09GMk9UVE8AAAIoAAkAAAAABTQAAAHjAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAADYFeBmAANAE2AiQDCAQGBYUXByAbkATIHoVx41OCqTlEyKzNPdpbBM//H6v7fkxk47Y1ULTYivRfwDo+gAu6wJGgE2XJnNfUEdnmZRU7GlA8WiByam5GzYjJGY8B4H+cyonlIrSe+MMortXzZRUa6593TJFqsRewTt9ii6jWNvRdWATBIohpMrjoJ+keIhhBRBK1Q3c32FdWy/3foheBEdkbFvmX1LCshxXjXMkbGP7bMsBjtAzwEndlwLtmcZjbXqJlRW1rLgt5sSKhiu0GD8/MkuPvich03nxxZ+oDxKFElqP//7BfsidpVxr37fTSWVdk9p+a+/vmZOwbk7odUNV82Ehv6pxzndwDrQ7ljQV1r16BB72JfOCLIjgF5fwLyBHkDSwC9avqK6AGAUDQCBDC0AN4MAiKGrfFAvk3i69FhwEABBC43XibtuTk49M+AP7mr4HYAwDQKAAEICrqMGoIYyh1SPw+YB8KaMjzwWgzQwgAFF4q0KR4wJAghCXIIzzEmUjvOukj9nOAgxziMEdEDFEnXsYixg8oLghCCg6KCG1oejxhaFGGJcMdHhpcpVdJH7GfAxzkEIc5ImOIarzl2k9B7dDdDfaV1ZJ/v6kORod5Z8uZrmMj0UTPut228nQHmoPtbtK0HeHh4NcijLWJCGV1lgAA') format('woff2');
  font-display: swap;
}
</style>
                    <style>
</style>
<style>
body {
  font-family: 'ipamjm', 'acgjm', serif;
}
</style>
        
    
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
        
        const fonts = ["'ipamjm'","'acgjm'","serif"];
        const fontFamily = fonts.join(', ');
        
        mermaid.initialize({
            startOnLoad: false,
            theme: window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'default',
            fontFamily: fontFamily
        });
        
        await mermaid.run({
            querySelector: '.mermaid'
        });
    </script>
</head>
<body>
    <main>
        
        <style>
            .search-container {
                max-width: 800px;
                margin: 0 auto;
                padding: 1rem;
            }
            .search-box {
                width: 100%;
                padding: 1rem;
                font-size: 1.2rem;
                border: 2px solid #ddd;
                border-radius: 8px;
                margin-bottom: 2rem;
            }
            .results-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                gap: 1rem;
            }
            .result-item {
                border: 1px solid #eee;
                border-radius: 8px;
                padding: 1rem;
                text-align: center;
                background: white;
                cursor: pointer;
                transition: transform 0.1s;
            }
            .result-item:hover {
                transform: scale(1.02);
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            }
            .r-char {
                font-size: 2.5rem;
                margin-bottom: 0.5rem;
            }
            .r-meta {
                font-size: 0.8rem;
                color: #666;
                font-family: monospace;
            }
            .r-font {
                font-size: 0.7rem;
                color: #888;
                margin-top: 0.2rem;
            }
            .loading {
                text-align: center;
                padding: 2rem;
                color: #666;
            }
        </style>

        <div class="search-container">
            <h1>Glyph Search</h1>
            <p>Search across all 145,000+ indexed glyphs from registered fonts.</p>
            
            <input type="text" id="searchInput" class="search-box" placeholder="Search by Glyph Name, ID, or Unicode (e.g. MJ010020)...">
            
            <div id="results" class="results-grid"></div>
            <div id="status" class="loading">Loading index...</div>
        </div>

        <script type="module">
            let index = [];
            const resultEl = document.getElementById('results');
            const statusEl = document.getElementById('status');
            const inputEl = document.getElementById('searchInput');
            const loadedFonts = new Set();

            try {
                const res = await fetch('/glyph-index.json');
                index = await res.json();
                statusEl.textContent = 'Loaded ' + index.length + ' glyphs. Type to search.';
            } catch (e) {
                statusEl.textContent = 'Error loading index.';
                console.error(e);
            }

            async function loadFont(filename, familyName) {
                if (loadedFonts.has(filename)) return;
                const fontFace = new FontFace(familyName, `url(/fonts/${filename})`);
                try {
                    await fontFace.load();
                    document.fonts.add(fontFace);
                    loadedFonts.add(filename);
                } catch(err) {
                    console.error('Failed to load font:', filename, err);
                }
            }

            window.showDetails = async (idx) => {
                const item = window.currentResults[idx];
                if (!item) return;

                const familyName = 'Preview-' + item.font_filename.replace(/\W/g, '');
                
                let dialog = document.getElementById('detail-dialog');
                if (!dialog) {
                    dialog = document.createElement('dialog');
                    dialog.id = 'detail-dialog';
                    dialog.style.padding = '2rem';
                    dialog.style.borderRadius = '8px';
                    dialog.style.border = '1px solid #ccc';
                    dialog.style.maxWidth = '500px';
                    dialog.style.width = '90%';
                    document.body.appendChild(dialog);
                }

                dialog.innerHTML = '<div style="text-align:center">Loading Font...</div>';
                dialog.showModal();

                await loadFont(item.font_filename, familyName);

                const char = item.unicode_hex ? String.fromCodePoint(parseInt(item.unicode_hex.replace('U+', ''), 16)) : (item.name.startsWith('u') ? String.fromCodePoint(parseInt(item.name.substring(1), 16)) : '?');

                dialog.innerHTML = `
                    <div style="text-align: right;"><button onclick="document.getElementById('detail-dialog').close()">Close</button></div>
                    <div style="text-align: center;">
                        <div style="font-family: '${familyName}'; font-size: 100px; line-height: 1.2; border: 1px dashed #ddd; margin: 1rem auto; width: 120px; height: 120px; display: flex; align-items: center; justify-content: center;">
                            ${char}
                        </div>
                        <h2>${item.name}</h2>
                        <div style="text-align: left; margin-top: 1rem; display: grid; grid-template-columns: auto 1fr; gap: 0.5rem;">
                            <strong>Unicode:</strong> <span>${item.unicode_hex || 'N/A'}</span>
                            <strong>Glyph Index:</strong> <span>${item.glyph_index}</span>
                            <strong>Advance Width:</strong> <span>${item.advance_width}</span>
                            <strong>Font File:</strong> <span>${item.font_filename}</span>
                            <strong>Font Family:</strong> <span>${item.font_family}</span>
                        </div>
                        <p style="margin-top: 1rem; font-size: 0.8rem; color: #666;">
                            Syntax: <code>[${item.name}]</code>
                        </p>
                    </div>
                `;
            };

            function render(items) {
                window.currentResults = items;
                const displayItems = items.slice(0, 100);
                
                resultEl.innerHTML = displayItems.map((item, idx) => {
                    const char = item.unicode_hex ? String.fromCodePoint(parseInt(item.unicode_hex.replace('U+', ''), 16)) : '?';
                    return `
                        <div class="result-item" onclick="showDetails(${idx})">
                            <div class="r-char">${char}</div>
                            <div class="r-meta">${item.name}</div>
                            <div class="r-font">${item.font_filename}</div>
                        </div>
                    `;
                }).join('');
                
                if (items.length > 100) {
                    const more = document.createElement('div');
                    more.style.gridColumn = '1 / -1';
                    more.style.textAlign = 'center';
                    more.style.padding = '1rem';
                    more.textContent = '...and ' + (items.length - 100) + ' more matches';
                    resultEl.appendChild(more);
                }
            }

            inputEl.addEventListener('input', (e) => {
                const q = e.target.value.toLowerCase().trim();
                if (!q) {
                    resultEl.innerHTML = '';
                    return;
                }
                const matches = index.filter(item => {
                    return (item.name && item.name.toLowerCase().includes(q)) || 
                           (item.unicode_hex && item.unicode_hex.toLowerCase().includes(q));
                });
                render(matches);
            });
        </script>
    
    </main>
</body>
</html>