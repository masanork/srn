---
title: "討議資料：Web/A - アーカイブ品質のWeb文書フォーマット"
layout: weba
date: 2024-12-24
author: "空音プロジェクトチーム"
description: "PDF/A や XML+XSLT の課題を解決する、ポータブルで機械可読な長期保存用Web文書フォーマットの提案。"
---

# Web/A: ポータブルで機械可読な、長期保存用Web文書フォーマットの提案

[English version (英語版)](./web-a.html)

## 1. 概要
本稿では、アーカイブ品質のWeb文書仕様である **Web/A** を提案する。長期の視覚的保存には PDF/A が広く利用されているが、PDF/A は構造や意味の抽出が困難な「データのサイロ」になりがちである。Web/A は、HTML5、CSS、JSON-LD といった標準的な Web 技術を活用し、人間と機械の両方が普遍的に読み取ることができ、単一ファイルとしてポータブルで、かつ暗号的に検証可能なフォーマットを実現する。

---

## 2. 背景と課題：PDF/A と XML の限界

### 2.1. PDF/A の課題：視覚的サイロ
PDF/A (ISO 19005) は文書の「見栄え」の保存には成功したが、自動データ処理の時代においては以下の課題がある：
- **不透明性**: 住所や金額などの特定データの抽出には AI やヒューリスティックな処理が必要であり、決定論的なデータ利用が困難。
- **アクセシビリティ**: テキストのリフローやスクリーンリーダー対応が、実装によって不完全になりやすい。

### 2.2. XML+XSLT の失敗：接続性の罠 (Connectivity Trap)
初期の電子政府プロジェクトでは、データ（XML）と表示（XSLT）を分離するアプローチが試みられた。しかし、これは「ビットロット（情報の腐敗）」を招いた：
- **依存関係の断絶**: XML は外部の XSLT ファイルなしでは判読不能だが、その XSLT が紛失したり、URL が無効になったりすることが多い。
- **ブラウザの進化**: モダンブラウザは XSLT のサポートを縮小（ローカル XSLT の制限等）しており、アーカイブされた文書が閲覧不能になるリスクがある。
- **XTX問題**: コンテンツとスタイルが分離されているため、人間が見ている内容と機械が読み取っている内容の「不一致」が発生しやすい。

Web/A は、**「自己記述的」「自己完結的」「セマンティック」**なフォーマットを提供することで、これらの溝を埋めることを目的とする。

---

## 3. Web/A の中核となる原則

### 3.1. 人間・機械・AI の三位一体 (The Triality)
すべての Web/A 文書は、単なる二層構造を超え、以下の三つの側面で最適化されなければならない：
1.  **人間可読レイヤー**: 高品質な HTML/CSS による視覚的提示。
2.  **機械可読レイヤー**: 基幹システムが処理するための厳格な JSON-LD。
3.  **セマンティック・アクセシビリティ (AI/Assistive)**: 構造化の徹底による、支援技術と AI への最適化。

ここで重要なのは、**「アクセシビリティ（支援技術への対応）」と「AI による解釈性」の収束**である。セマンティックに正しくマークアップされた文書は、視覚障害者のスクリーンリーダーにとっても、情報の要約や推論を行う AI モデルにとっても、等しく「読みやすい」ものとなる。Web/A は PDF/A が抱えていたアクセシビリティ対応の複雑さを、Web 標準のセマンティック HTML によって解消する。

### 3.2. 極めて高いポータビリティ (Self-Contained)
フォント、画像、スタイルは Data URL 等によりインライン化、または同梱される。50年後のブラウザでも、外部サーバーにアクセスすることなく機能することが保証される。

### 3.3. 静的なフォーマッティング
Web/A は **静的 CSS** を使用する。JavaScript なしでレンダリングが完結するため、ブラウザエンジンの挙動変化の影響を受けにくく、発行時の見栄えを維持できる。

### 3.4. 暗号による真正性保証
分散型 ID (DID) や検証可能証明書 (VC) と統合され、デジタル署名が付与される。署名は視覚的な HTML とセマンティックな JSON-LD の両方を対象とし、改ざんを防止する。

---

## 4. Web/A コンプライアンス・レベル
PDF/A-1a/1b のように、用途に応じた厳格さのレベルを定義する：

- **Web/A-1s (Semantic)**:
  - 有効な HTML5 + CSS。
  - 有効な JSON-LD の埋め込み。
  - 基本的なデジタル署名。
- **Web/A-1u (Universal)**:
  - 1s の全要件に加え、外部リクエストを禁止。
  - 全アセットのインライン化。
  - 使用文字のみを抽出したサブセットフォントの埋め込み。
- **Web/A-1p (Provenance)**:
  - 1u の全要件に加え、**C2PA形式のプロバンス・マニフェスト**を保持。
  - 生成ツールによる「人間・機械レイヤーの同一性 (HMP)」の署名付き宣言を含む。
  - *対象*: 高い信頼性が必要な公文書や証跡記録。

---

## 5. 技術構築モデル

### 5.1. 多層保守モデル (Multi-Layer Maintenance)
ブラウザの進化による閲覧不能（XSLT問題の再来）を防ぐため、文書内に二つのレイヤーを定義する：
1.  **署名済みコンテンツ・レイヤー（ペイロード）**: 発行者によって暗号的に署名された、変更不可の「事実」としてのレイヤー。
2.  **ポータブル・ビューアー・レイヤー（ラッパー）**: 将来のブラウザでレンダリングするための CSS やフォント。
    *   **進化的保守**: 長期保存の過程で行われる「署名の洗替（Signature Refresh）」時に、このラッパー層のみを当時の最新技術に更新することが許容される。

### 5.2. 人間と機械の同一性 (Human-Machine Parity : HMP) 
生成ツール（Sorane等）は、JSON-LD と HTML が乖離しないことを保証する責任を持つ：
- **静的同期**: HTML は JSON-LD と同じデータソースから同時に生成（ベイク）される。
- **生成ツール宣言**: C2PA マニフェストを埋め込み、「このツールが同一性を持って生成した」ことを署名付きで記録する。

#### 5.2.1. セマンティック・マッピング（検証可能性の向上）
第三者による監査やスクリプトでの突合を容易にするため、表示レイヤーの HTML 要素に対し、JSON-LD のプロパティとの対応を示す属性（例：`data-weba-field`）を付与することを推奨する。
- **例**: `<span data-weba-field="author.name">空音 太郎</span>`
これにより、署名されたペイロード内で「どの表示項目が、どの機械可読データに基づいているか」を透明化し、視覚的な偽装を防止する。

---

## 6. 実装の柔軟性と鍵管理：ライトウェイト・トラストモデル
アーカイブ品質の署名において、鍵管理の複雑さは最大の導入障壁となっている。Web/A は、高い安全性を担保する HSM（ハードウェア・セキュリティ・モジュール）等による厳格な管理を否定するものではなく、それらを補完し、より広範な普及を促すための「ライトウェイト・トラストモデル」を提案する。

本モデルの真価は、専用の鍵管理インフラを構築せずとも、**既存の Web アプリケーション基盤上で安全に署名文書を発行できる点**にある。これにより、VC の普及に不可欠な「発行体の多様性」と「スモールスタート」を両立させる。

特に **耐量子暗号 (PQC)** への移行において、このモデルは極めて有効である。既存の PKI や HSM 基盤が PQC に完全対応するのを待つのではなく、Passkey などの既存の信頼基盤をルートとしつつ、ビルドプロセスにおいて PQC 署名を動的に生成・付与することで、**PQC の「安全な先行施行」**を可能にする。

### 6.1. 権限委譲：Passkey からビルド鍵へ
高価な HSM を全ビルドで回す代わりに、**委譲型アイデンティティ**を活用する：
1.  **Root of Trust**: 開発者端末の **Passkey (WebAuthn)** を信頼の基点とする。
2.  **委譲証明書 (Delegate Certificate)**: ビルド時のみ有効な短期間の鍵（エフェメラル鍵）を Root 鍵で認可する。
3.  **CI/CD での署名**: ビルド鍵が文書に署名し、その正当性は Passkey への遡及によって証明される。

### 6.2. エフェメラルな発行
鍵の漏洩リスクを最小化するため、ビルドごとに使い捨ての鍵ペアを生成し、サイト上で公開される **`key-history.json`（公開透明性ログ）** に記録する。

---

## 7. 高度なタイポグラフィと帳票表現
Web/A は、PDF/A が得意としてきた「帳票の忠実な再現」と、Web が得意とする「データの流動性」を高度にバランスさせる必要がある。

### 7.1. 文字の網羅性：行政事務標準文字と外字への対応
日本の行政事務で不可欠な「行政事務標準文字」や「人名外字」への対応は、Web/A において以下の二段構えで実現される：
- **WebFont サブセット化**: IVS (Ideographic Variation Sequence) を含む膨大な文字セットから、その文書で実際に使用されている字形のみを抽出して埋め込む。
- **SVG 埋め込み**: フォント化が困難な特殊な図形文字や、超一過性の外字については、パスデータとして HTML 内に直接インライン化する。
これにより、クライアント側の環境に依存することなく、100% の文字再現性を確保する。

### 7.2. 帳票レイアウトの再現と課題
日本の公文書は伝統的に「A4 縦、罫線あり」の固定様式を前提としている。Web/A において CSS を用いた帳票レイアウトの再現は可能だが、以下の課題が残る：
- **ピクセル・パーフェクトの追求**: ブラウザごとのレンダリングエンジンの微差により、ミリ単位の配置を固定することの難しさ。
- **リフロー性との衝突**: 文字サイズ変更などのアクセシビリティ対応と、固定枠レイアウトをいかに両立させるか。

### 7.3. スマホ時代の「バイモーダル・プレゼンテーション」
スマートフォンの普及により、文書には**二つの提示様態（バイモーダル）**が求められる：
1.  **アーカイブ・ビュー (Fixed)**: 従来の帳票形式。印刷時や、公的な真正性確認の際に利用する「公式な顔」。
2.  **ウォレット・ビュー (Adaptive)**: スマホ画面に最適化されたカード形式。日々の利用において内容を即座に確認するための「実務的な顔」。
Web/A の Viewer レイヤーは、単一のペイロードからこれら二つのビューを CSS で切り替えて提供し、管理コストを抑えつつモバイル体験を最大化する。

---

## 8. 空音 (Sorane) における実装
Sorane プロジェクトは、Web/A-1p レベルをデフォルトで実装している：
1.  **プロバンス・マニフェスト**: JSON-LD 内に自動注入。
2.  **フォント内署名**: サブセットフォントへの `SRNC` テーブル注入による完全性保護。
3.  **ハイブリッド署名**: Ed25519 と ML-DSA-44（耐量子暗号）による二重署名。

---

## 9. 段階的な導入ロードマップ：利用シーンに応じた階層化
すべての文書に最初からフルスペックの VC 要件（Holder Binding 等）を課すことは、システム構築の難易度を引き上げ、普及を妨げる要因となる。Web/A は、技術の成熟度とユースケースの切実さに応じた段階的な導入を推奨する。

### レイヤー 1：公表用文書・広報資料（現時点の空音のスコープ）
不特定多数に公開される官報、統計データ、ホワイトペーパー等が対象。
*   **技術要件**: 真正性（署名）と長期閲覧性の確保。
*   **特性**: リプレイアタック（再利用攻撃）のリスクが低く、情報の公開性そのものに価値がある。

### レイヤー 2：個人宛のプライバシー情報を含む文書
特定の個人や組織に対して発出される通知書、受領書、非公開の報告書等が対象。
*   **技術要件**: レイヤー1の要件に加え、適切なアクセス制御と秘匿性の確保。
*   **特性**: プライバシー保護が重要となるが、提出先での厳格な本人確認までは必ずしも求められない。

### レイヤー 3：本人確認・権限証明書類（Holder Binding 必須）
住民票の写し、委任状、社員証、資格証明書など、二次流通時において本人性を証明する必要がある文書が対象。
*   **技術要件**: **Holder Binding（所持者結合）**。証明書とそれを提示する個人のアイデンティティ（スマホ内の秘密鍵や JPKI 等）が暗号的に結合されていること。
*   **特性**: 他人へのなりすましや不正利用を防止する必要があり、最も高い信頼性が求められる。

---

## 10. 技術的課題と標準化への展望
Web/A の真の普及には、単一のフォーマット規定を超え、エコシステム全体での技術的課題の解決と標準化が不可欠である。

### 10.1. クロスデバイス・対面授受のプロトコル
ブラウザ上で閲覧されている Web/A 文書を、対面で相手のスマートフォンに「手渡す」ためのプロトコルにはまだ改善の余地がある。
- **課題**: QRコードの読み取り、NFC/BLE を介した近距離通信がブラウザからシームレスに行えるための標準 API の確立。
- **展望**: ISO/IEC 18013-5 (mDL) や OID4VP などのモバイルウォレット標準との、ブラウザネイティブな統合。

### 10.2. Holder Binding の実装技術
レイヤー3（本人確認書類）で必須となる所持者結合を、既存の Web アーキテクチャでいかに実現するか。
- **課題**: 端末の Secure Enclave に保存された秘密鍵による署名（Passkey 等）を、Web コンテンツ側から「プライバシーを保護したまま」呼び出し、プレゼンテーションへと動的に結合させる手法。
- **展望**: SD-JWT や SD-COSE を活用した、特定の属性のみを選択的に開示しつつ本人性を証明する技術のブラウザ実装。

### 10.3. フォーマットのネイティブサポート
ブラウザが Web/A を特別な文書として認識するための標準化が必要である。
- **展望**: ブラウザのアドレスバー付近で、その文書の署名状態や HMP（人間・機械の一貫性）を直接表示する標準 UI の策定。

### 10.4. 信頼の継承 (Trust Transition) の規格化
50年以上の長期保存において、署名を最新の暗号アルゴリズムへ洗替（Refresh）するプロセスの標準化。
- **展望**: 複数のアーカイブ機関（NDL、公文書館、民間クラウド等）が共通して解釈可能な、署名継承履歴の証跡（バーチャルな信頼の連鎖）に関するプロトコルの策定。

### 10.5. 法的位置付け：証拠力の向上と技術的検証可能性
Web/A は、必ずしも電子署名法が定める「意思表示の代替としての電子署名」の枠組みに固執するものではない。
- **真正な成立の証明**: 公文書においては民事訴訟法上の推定規定が働くが、私文書において Web/A は、その「真正な成立（改ざんがないこと、発行元が確かであること）」を客観的・技術的に検証可能にすることで、裁判外・裁判内を問わず文書の**証拠力**を高めることに寄与する。
- **PKI エコシステムとの適度な距離**: 厳格な本人確認（意思の発露）を必要とする文書以外であれば、必ずしも高コストな PKI インフラに依存せずとも、ライトウェイト・トラストモデルによる検証可能性だけで十分な社会的・実務的価値を提供できる。

### 10.6. エコシステム戦略：AI エージェント・ファースト
短期的にはフルスペックのモバイル・ウォレットの普及を待つのではなく、開発者や AI エージェントが直接利用できるツールの提供を優先する。
- **Headless Wallet (CLI / MCP)**: Gemini-CLI や Claude Code といった AI エージェントが、メタデータを読み取り、自律的に申請・発行・検証を行えるコマンドライン・ツールや MCP (Model Context Protocol) サーバーの開発。
- **プログラム可能なアイデンティティ**: AI が Web/A 文書を「処理」する際、その真正性を API 経由で即座に検証し、信頼スコアを算出する。これにより、人間が UI を操作するよりも先に、AI 同士の自動化された信頼チェーンが構築される。

---

## 11. 国際標準化の文脈とコミュニティへの貢献
Web/A は、全く新しい技術をゼロから定義するのではなく、既存の国際標準を「長期保存と検証可能性」という観点から統合・最適化したプロファイルである。以下のコミュニティにおける議論との高い親和性を持つ。

### 11.1. W3C Verifiable Credentials (VC)
Web/A は、W3C VC 2.0 仕様を「文書」という特定の形式にパッケージングするための **Document-centric Profile** と位置づけられる。メタデータ（JSON-LD）と表示（HTML）を不可分に結合し、ブラウザさえあれば誰でも検証可能にする実装モデルは、VC の実務的な普及に寄与する。

### 11.2. IETF SPICE / COSE
バイナリ形式の証明書や選択的開示（SD-COSE）を HTML 文書に応用する試みは、IETF の SPICE WG 等における議論の実証的な一例となる。特に PQC（耐量子暗号）署名を既存インフラ上で安全に運用する「ライトウェイト・トラストモデル」は、次世代のセキュアなインフラ構築への示唆を含む。

### 11.3. C2PA (Provenance)
画像や動画を対象とした C2PA (Provenance) 仕様を、HTML ベースのテキスト文書へと拡張し、フォントのサブセット化まで含めた「生成プロセス全体の真正性」を保証するモデルは、C2PA をテキスト領域へ深化させるプロファイル提案となる。

---

## 12. 結びに代えて
Web/A は、既存の Web 技術と Verifiable Credentials のエコシステムの間に存在する、長期保存や人間・機械の同一性といった「欠落」を埋めるための試論である。

本稿で整理した価値体系や技術的課題は、単一のフォーマットの提案に留まるものではない。次世代の電子行政、デジタル遺産管理、そして多機関が関与する長期的な知識管理において、真に持続可能で検証可能なインフラを構築するための「議論の土台」として位置づけたい。
